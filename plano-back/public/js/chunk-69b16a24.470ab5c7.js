(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69b16a24","chunk-5328f8bf"],{"31eb":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-component"},[a("PageHeader",{attrs:{title:"Planos"}},[a("BaseButton",{attrs:{template:"file-upload"},on:{click:function(e){return t.$refs.modalImportPlano.open()}}}),a("BaseButton",{attrs:{template:"ajuda"},on:{click:function(e){return t.$refs.modalAjuda.toggle()}}})],1),a("div",{staticClass:"page-content"},[a("div",{staticClass:"div-table"},[a("BaseTable",{attrs:{styles:"height:max-content"},scopedSlots:t._u([{key:"thead",fn:function(){return[a("th",{staticClass:"t-start clickable",staticStyle:{width:"70px"},on:{click:function(e){return t.toggleOrder(t.ordenacaoMainPlanos,"ano")}}},[t._v("\n            Ano\n            "),a("i",{class:t.setIconByOrder(t.ordenacaoMainPlanos,"ano")})]),a("th",{staticClass:"t-start clickable",staticStyle:{width:"150px"},on:{click:function(e){return t.toggleOrder(t.ordenacaoMainPlanos,"nome")}}},[t._v("\n            Nome\n            "),a("i",{class:t.setIconByOrder(t.ordenacaoMainPlanos,"nome")})]),a("th",{staticClass:"t-start clickable",staticStyle:{width:"300px"},on:{click:function(e){return t.toggleOrder(t.ordenacaoMainPlanos,"obs")}}},[t._v("\n            Observação\n            "),a("i",{class:t.setIconByOrder(t.ordenacaoMainPlanos,"obs")})]),a("th",{staticStyle:{width:"80px"}},[t._v("\n            Editável\n          ")]),a("th",{staticStyle:{width:"80px"}},[t._v("\n            Visível\n          ")])]},proxy:!0},{key:"tbody",fn:function(){return t._l(t.PlanosOrdered,function(e){return a("tr",{key:e.id,class:{"bg-selected":e.id===t.planoSelectedId},on:{click:function(a){return t.handleClickInPlano(e)}}},[a("td",{staticClass:"t-start",staticStyle:{width:"70px"}},[t._v(t._s(e.ano))]),a("td",{staticClass:"t-start",staticStyle:{width:"150px"}},[t._v(t._s(e.nome))]),a("td",{staticClass:"t-start",staticStyle:{width:"300px"}},[t._v(t._s(e.obs))]),a("td",{staticClass:"t-start",staticStyle:{width:"80px"}},[t._v(t._s(e.isEditable))]),a("td",{staticClass:"t-start",staticStyle:{width:"80px"}},[t._v(t._s(e.visible))])])})},proxy:!0}])})],1),a("Card",{attrs:{title:"Plano",toggleFooter:t.isEdit,isPlano:t.isEdit},on:{"btn-salvar":t.handleEditPlano,"btn-delete":t.openModalDelete,"btn-add":t.openModalNovoPlano,"btn-clean":t.cleanPlano,"btn-copy":function(e){return t.copyPlano(t.planoForm)}},scopedSlots:t._u([{key:"form-group",fn:function(){return[a("div",{staticClass:"row mb-2 mx-0"},[a("div",{staticClass:"form-group col m-0 px-0"},[a("label",{attrs:{required:"",for:"planoNome"}},[t._v("Nome")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.planoForm.nome,expression:"planoForm.nome"}],staticClass:"form-control",attrs:{type:"text",id:"planoNome"},domProps:{value:t.planoForm.nome},on:{keypress:t.limitNomeLength,input:function(e){e.target.composing||t.$set(t.planoForm,"nome",e.target.value)}}})])]),a("div",{staticClass:"row mb-2 mx-0"},[a("div",{staticClass:"form-group col m-0 px-0"},[a("label",{attrs:{required:"",for:"ano"}},[t._v("Ano")]),a("select",{directives:[{name:"model",rawName:"v-model.number",value:t.planoForm.ano,expression:"planoForm.ano",modifiers:{number:!0}}],staticClass:"form-control input-ano",attrs:{id:"planoAno"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(e){var a="_value"in e?e._value:e.value;return t._n(a)});t.$set(t.planoForm,"ano",e.target.multiple?a:a[0])}}},t._l(t.AnosDoPlano,function(e){return a("option",{key:"ano"+e,domProps:{value:e}},[t._v("\n                "+t._s(e)+"\n              ")])}),0)])]),a("div",{staticClass:"row mb-2 mx-0"},[a("div",{staticClass:"form-group col m-0 px-0"},[a("label",{attrs:{for:"planoObs"}},[t._v("Observações")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.planoForm.obs,expression:"planoForm.obs"}],staticClass:"form-control",attrs:{id:"planoObs",cols:"30",rows:"3"},domProps:{value:t.planoForm.obs},on:{input:function(e){e.target.composing||t.$set(t.planoForm,"obs",e.target.value)}}})])]),a("div",{staticClass:"row mb-2 mx-0"},[a("div",{staticClass:"form-group col m-0 px-0"},[a("label",{attrs:{required:"",for:"planoEditavel"}},[t._v("Editável")]),a("select",{directives:[{name:"model",rawName:"v-model.number",value:t.planoForm.isEditable,expression:"planoForm.isEditable",modifiers:{number:!0}}],staticClass:"form-control input-ano",attrs:{id:"planoEditavel"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(e){var a="_value"in e?e._value:e.value;return t._n(a)});t.$set(t.planoForm,"isEditable",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"true"}},[t._v("Sim")]),a("option",{attrs:{value:"false"}},[t._v("Não")])])])]),a("div",{staticClass:"row mb-2 mx-0"},[a("div",{staticClass:"form-group col m-0 px-0"},[a("label",{attrs:{required:"",for:"planoVisivel"}},[t._v("Visível")]),a("select",{directives:[{name:"model",rawName:"v-model.number",value:t.planoForm.visible,expression:"planoForm.visible",modifiers:{number:!0}}],staticClass:"form-control input-ano",attrs:{id:"planoVisivel"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(e){var a="_value"in e?e._value:e.value;return t._n(a)});t.$set(t.planoForm,"visible",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"true"}},[t._v("Sim")]),a("option",{attrs:{value:"false"}},[t._v("Não")])])])])]},proxy:!0}])})],1),a("ModalNovoPlano",{ref:"modalNovoPlano",attrs:{plano:t.planoForm}}),a("ModalDelete",{ref:"modalDelete",attrs:{isDeleting:t.isEdit},on:{"btn-deletar":t.handleDeletePlano}},[a("li",{staticClass:"list-group-item"},[t.isEdit?a("span",[t._v("\n        Tem certeza que deseja excluír o plano\n        "),a("b",[t._v(t._s(t.planoForm.ano+" - "+t.planoForm.nome))]),t._v("\n        ?\n      ")]):a("span",{staticClass:"list-group-item"},[t._v("Nenhum plano selecionado.")])])]),a("ModalAjuda",{ref:"modalAjuda"},[a("li",{staticClass:"list-group-item"},[a("b",[t._v("Adicionar:")]),t._v("\n      Preencha o cartão em branco à direita e em seguida, clique em Adicionar\n      "),a("font-awesome-icon",{staticClass:"icon-green",attrs:{icon:["fas","plus"]}}),t._v("\n      .\n    ")],1),a("li",{staticClass:"list-group-item"},[a("b",[t._v("Editar:")]),t._v("\n      Clique na linha da tabela do plano que deseja alterar. Em seguida, no cartão à\n      direita, altere as informações que desejar e clique em Salvar\n      "),a("font-awesome-icon",{staticClass:"icon-green",attrs:{icon:["fas","check"]}}),t._v("\n      .\n    ")],1),a("li",{staticClass:"list-group-item"},[a("b",[t._v("Deletar:")]),t._v("\n      Clique na linha da tabela do plano que deseja remover. Em seguida, no cartão à\n      direita, clique em Remover\n      "),a("font-awesome-icon",{staticClass:"icon-red",attrs:{icon:["fas","trash-alt"]}}),t._v("\n      e confirme a remoção na janela que será aberta.\n    ")],1),a("li",{staticClass:"list-group-item"},[a("b",[t._v("Copiar:")]),t._v("\n      Clique na linha da tabela do plano que deseja copiar. Em seguida, no cartão à\n      direita, clique em Copiar\n      "),a("font-awesome-icon",{staticClass:"icon-lightblue",attrs:{icon:["fas","copy"]}}),t._v("\n      .\n    ")],1),a("li",{staticClass:"list-group-item"},[a("b",[t._v("Limpar:")]),t._v("\n      No cartão à direita, clique em Cancelar\n      "),a("font-awesome-icon",{staticClass:"icon-gray",attrs:{icon:["fas","times"]}}),t._v("\n      , para limpar as informações.\n    ")],1),a("li",{staticClass:"list-group-item"},[a("b",[t._v("Ordenar:")]),t._v("\n      Clique no cabeçalho da tabela, na coluna desejada, para alterar a ordenação das\n      informações.\n    ")])]),a("ModalImportPlano",{ref:"modalImportPlano"})],1)},o=[],r=(a("a481"),a("96cf"),a("3b8d")),i=a("cebc"),s=a("2f62"),l=a("9165"),c=a("d027"),u=a("25df"),d=a("795b"),p=a.n(d),f=a("2b0e"),m={copyPlano:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f["default"].axios.post("/copyPlano/".concat(t,"&&").concat(e),a).then(function(t){return p.a.resolve(t.data)}).catch(function(t){return p.a.reject(t)})}},v=a("ebd8"),h=a("6e60"),b=a("f6c9"),g={ano:"",nome:"",obs:"",isEditable:"true",visible:"true"},_={name:"Planos",mixins:[l["n"]],components:{ModalAjuda:c["a"],ModalDelete:c["b"],Card:u["b"],ModalNovoPlano:h["default"],ModalImportPlano:b["default"]},data:function(){return{planoForm:this.$_.clone(g),planoSelectedId:null,ordenacaoMainPlanos:{order:"ano",type:"asc"}}},methods:Object(i["a"])({},Object(s["b"])(["deletePlano","editPlano"]),{limitNomeLength:function(t){t.target.value.length>=10&&t.preventDefault()},handleClickInPlano:function(t){this.cleanPlano(),this.planoSelectedId=t.id,this.planoForm=this.$_.clone(t)},cleanPlano:function(){this.planoSelectedId=null,this.planoForm=this.$_.clone(g)},openModalDelete:function(){this.$refs.modalDelete.open()},openModalNovoPlano:function(){""===this.planoForm.ano||null===this.planoForm.ano||""===this.planoForm.nome||null===this.planoForm.nome?this.pushNotification({type:"error",text:"Campos obrigatórios inválidos ou incompletos."}):this.$refs.modalNovoPlano.open()},handleEditPlano:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.setPartialLoading(!0),t.next=4,this.editPlano(this.planoForm);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),this.pushNotification({type:"error",title:"Erro ao atualizar plano",text:t.t0.message||""});case 9:return t.prev=9,this.setPartialLoading(!1),t.finish(9);case 12:case"end":return t.stop()}},t,this,[[0,6,9,12]])}));function e(){return t.apply(this,arguments)}return e}(),handleDeletePlano:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.setPartialLoading(!0),t.next=4,this.deletePlano(this.planoForm);case 4:this.cleanPlano(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.pushNotification({type:"error",title:"Erro ao deletar plano",text:"Tente novamente"});case 10:return t.prev=10,this.setPartialLoading(!1),t.finish(10);case 13:case"end":return t.stop()}},t,this,[[0,7,10,13]])}));function e(){return t.apply(this,arguments)}return e}(),copyPlano:function(t){var e=this,a={nome:"Cópia de '".concat(t.nome,"'"),ano:t.ano,obs:"Cópia do plano '".concat(t.nome," - ").concat(t.ano,"'")};v["a"].create(a).then(function(a){m.copyPlano(t.id,a.Plano.id).then(function(a){e.$notify({group:"general",title:"Sucesso!",text:"O Plano ".concat(t.nome," foi copiado!"),type:"success"})}).catch(function(t){e.error="<b>Erro ao copiar plano</b>",t.response.data.fullMessage&&(e.error+="<br/>"+t.response.data.fullMessage.replace("\n","<br/>")),e.$notify({group:"general",title:"Erro!",text:e.error,type:"error"})})})}}),computed:Object(i["a"])({},Object(s["c"])(["AllPlanos","AnosDoPlano"]),{PlanosOrdered:function(){var t=this.ordenacaoMainPlanos,e=t.order,a=t.type;return this.$_.orderBy(this.AllPlanos,e,a)},isEdit:function(){return null!=this.planoSelectedId}})},x=_,y=(a("7624"),a("2877")),P=Object(y["a"])(x,n,o,!1,null,"7695d1a2",null);e["default"]=P.exports},"469f":function(t,e,a){a("6c1c"),a("1654"),t.exports=a("7d7b")},"4f37":function(t,e,a){"use strict";a("aa77")("trim",function(t){return function(){return t(this,3)}})},"5d73":function(t,e,a){t.exports=a("469f")},7624:function(t,e,a){"use strict";var n=a("c9f7"),o=a.n(n);o.a},"7d7b":function(t,e,a){var n=a("e4ae"),o=a("7cd6");t.exports=a("584a").getIterator=function(t){var e=o(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},"7f7f":function(t,e,a){var n=a("86cc").f,o=Function.prototype,r=/^\s*function ([^ (]*)/,i="name";i in o||a("9e1e")&&n(o,i,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},a21f:function(t,e,a){var n=a("584a"),o=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},c9f7:function(t,e,a){},f499:function(t,e,a){t.exports=a("a21f")},f6c9:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("BaseModal",{ref:"baseModal",attrs:{title:"Importar plano",position:"center",hasBackground:!0,hasFooter:!0},scopedSlots:t._u([{key:"modal-body",fn:function(){return[a("input",{ref:"inputFilePlano",attrs:{type:"file"}})]},proxy:!0},{key:"modal-footer",fn:function(){return[a("BaseButton",{staticClass:"ml-auto",attrs:{color:"lightblue",text:"Importar"},on:{click:t.handleImportPlano}})]},proxy:!0}])})},o=[],r=(a("4f37"),a("6762"),a("2fdb"),a("7514"),a("759f"),a("5d73")),i=a.n(r),s=a("e814"),l=a.n(s),c=(a("7f7f"),a("28a5"),a("a745")),u=a.n(c);function d(t){if(u()(t))return t}function p(t,e){var a=[],n=!0,o=!1,r=void 0;try{for(var s,l=i()(t);!(n=(s=l.next()).done);n=!0)if(a.push(s.value),e&&a.length===e)break}catch(c){o=!0,r=c}finally{try{n||null==l["return"]||l["return"]()}finally{if(o)throw r}}return a}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function m(t,e){return d(t)||p(t,e)||f()}a("a481");var v=a("f499"),h=a.n(v),b=(a("96cf"),a("3b8d")),g=a("cebc"),_=a("1146"),x=a.n(_),y=a("2f62"),P=a("eaf8"),C={name:"ModalImportPlano",methods:Object(g["a"])({},Object(y["b"])(["createTurma","editPedido"]),{open:function(){this.$refs.baseModal.open()},toggle:function(){this.$refs.baseModal.toggle()},close:function(){this.$refs.baseModal.close()},handleImportPlano:function(){var t=Object(b["a"])(regeneratorRuntime.mark(function t(){var e,a,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.AllTurmas.length){t.next=4;break}return this.pushNotification({type:"error",text:"Plano atual deve estar vázio para fazer a importação!"}),this.$refs.baseModal.close(),t.abrupt("return");case 4:this.setPartialLoading(!0),e=this.$refs.inputFilePlano.files[0],a=new FileReader,a.onload=function(){var t=Object(b["a"])(regeneratorRuntime.mark(function t(a){var o,r,i,s,c,u,d,p,f;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return o=x.a.read(a.target.result,{type:"binary"}),r=o.Sheets[o.SheetNames[0]],i=h()(x.a.utils.sheet_to_json(r)),s=i.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,""),c=JSON.parse(s),u=e.name.split("."),d=m(u,2),p=d[1],f=l()(p)||null,t.next=9,n.createPlanoImported(c.slice(480,500),f);case 9:return t.next=11,n.$store.dispatch("fetchAll");case 11:n.$refs.baseModal.close(),n.setPartialLoading(!1);case 13:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),a.readAsBinaryString(e);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),createPlanoImported:function(){var t=Object(b["a"])(regeneratorRuntime.mark(function t(e){var a,n,o,r,s,l,c,u,d,p,f,v,h,b,_,x,y,C=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(r in a=C.length>1&&void 0!==C[1]?C[1]:1,n={disciplinaCod:null,letra:null,cursoCod:null,vagas1:null,vagas2:null,horarioESala:null},o=0,e[0])1===o?n.disciplinaCod=r:2===o?n.letra=r:3===o?n.cursoCod=r:5===o?n.vagas1=r:6===o?n.vagas2=r:7===o&&(n.horarioESala=r),o++;s={},l=!0,c=!1,u=void 0,t.prev=8,d=i()(e);case 10:if(l=(p=d.next()).done){t.next=32;break}if(f=p.value,v=Object(P["b"])(),v.periodo=a,v.letra=f[n.letra]||null,v.Disciplina=this.findDisciplinaId(f[n.disciplinaCod]),f[n.horarioESala]&&(h=f[n.horarioESala].split(";"),b=m(h,2),_=b[0],x=b[1],v.Horario1=this.findHorarioId(_),v.Horario2=this.findHorarioId(x),v.turno1=this.findTurno(v.Horario1,v.Horario2),"EAD"!==v.turno1&&(v.Sala1=this.findSalaId(_),v.Sala2=this.findSalaId(x))),v.Disciplina&&v.letra&&v.turno1){t.next=19;break}return t.abrupt("continue",29);case 19:if(!this.isTheSameTurma(s,v)){t.next=23;break}return t.next=22,this.createPedido(f,n,s.id);case 22:return t.abrupt("continue",29);case 23:return t.next=25,this.createTurma(v);case 25:return y=t.sent,s=Object(g["a"])({},y),t.next=29,this.createPedido(f,n,y.id);case 29:l=!0,t.next=10;break;case 32:t.next=38;break;case 34:t.prev=34,t.t0=t["catch"](8),c=!0,u=t.t0;case 38:t.prev=38,t.prev=39,l||null==d.return||d.return();case 41:if(t.prev=41,!c){t.next=44;break}throw u;case 44:return t.finish(41);case 45:return t.finish(38);case 46:case"end":return t.stop()}},t,this,[[8,34,38,46],[39,,41,45]])}));function e(e){return t.apply(this,arguments)}return e}(),createPedido:function(){var t=Object(b["a"])(regeneratorRuntime.mark(function t(e,a,n){var o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(o={Turma:null,Curso:null,vagasNaoPeriodizadas:0,vagasPeriodizadas:0,vagasOferecidas:0,vagasOcupadas:0},o.Turma=n,o.Curso=this.findCursoId(e[a.cursoCod]),o.vagasOferecidas=e[a.vagas1],o.vagasOcupadas=e[a.vagas2],!o.Curso){t.next=10;break}return t.next=8,this.editPedido(o);case 8:t.next=11;break;case 10:console.log("Curso não econtrado: "+e[a.cursoCod]);case 11:case"end":return t.stop()}},t,this)}));function e(e,a,n){return t.apply(this,arguments)}return e}(),findTurno:function(t,e){return t||e?31==t?"EAD":this.$_.some(this.HorariosNoturno,["id",t])||this.$_.some(this.HorariosNoturno,["id",e])?"Noturno":"Diurno":null},findCursoId:function(t){var e=this.$_.find(this.AllCursos,["codigo",t]);return e?e.id:null},findDisciplinaId:function(t){var e=this.$_.find(this.AllDisciplinas,["codigo",t]);return e?e.id:null},findHorarioId:function(t){if(!t)return null;var e=t.split(","),a=m(e,3),n=a[0],o=a[1],r=a[2],i=this.parseDiaEHora(n,o);if(i){var s=this.$_.find(this.AllHorarios,["horario",i]);return s?s.id:null}return Object(P["c"])(r).includes(Object(P["c"])("HORÁRIO EAD"))?(console.log("EAD sala",r),31):null},parseDiaEHora:function(t,e){if(!t||!e)return null;var a=null,n=null;switch(t.trim().substring(0,3).toLowerCase()){case"seg":a="2a";break;case"ter":a="3a";break;case"qua":a="4a";break;case"qui":a="5a";break;case"sex":a="6a";break;case"sab":return"EAD"}var o=this.$_.find(this.ListaDeTodosHorarios,function(t){return t.nome.includes(e.substring(0,2)+"-")})||{};return n=o.nome,a&&n?a+" "+n:null},findSalaId:function(t){if(!t)return null;var e=t.split(","),a=m(e,3),n=a[2],o=Object(P["c"])(n),r=this.$_.find(this.AllSalas,function(t){var e=Object(P["c"])(t.nome);return o.includes(e)});return r?r.id:null},isTheSameTurma:function(t,e){return t.letra===e.letra&&t.Disciplina===e.Disciplina&&t.turno1===e.turno1&&t.Horario1===e.Horario1&&t.Horario2===e.Horario2}}),computed:Object(g["a"])({},Object(y["c"])(["AllHorarios","HorariosNoturno","AllDisciplinas","AllCursos","ListaDeTodosHorarios","AllTurmas","AllSalas"]))},w=C,k=a("2877"),O=Object(k["a"])(w,n,o,!1,null,null,null);e["default"]=O.exports}}]);
//# sourceMappingURL=chunk-69b16a24.470ab5c7.js.map