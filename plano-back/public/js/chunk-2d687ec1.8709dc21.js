(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d687ec1"],{"0bad":function(e,r,t){"use strict";t("af8d")},"28a5":function(e,r,t){"use strict";var n=t("aae3"),a=t("cb7c"),i=t("ebd6"),o=t("0390"),c=t("9def"),l=t("5f1b"),u=t("520a"),s=t("79e5"),f=Math.min,d=[].push,p="split",b="length",v="lastIndex",h=4294967295,m=!s((function(){RegExp(h,"y")}));t("214f")("split",2,(function(e,r,t,s){var g;return g="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[b]||2!="ab"[p](/(?:ab)*/)[b]||4!="."[p](/(.?)(.?)/)[b]||"."[p](/()()/)[b]>1||""[p](/.?/)[b]?function(e,r){var a=String(this);if(void 0===e&&0===r)return[];if(!n(e))return t.call(a,e,r);var i,o,c,l=[],s=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,p=void 0===r?h:r>>>0,m=new RegExp(e.source,s+"g");while(i=u.call(m,a)){if(o=m[v],o>f&&(l.push(a.slice(f,i.index)),i[b]>1&&i.index<a[b]&&d.apply(l,i.slice(1)),c=i[0][b],f=o,l[b]>=p))break;m[v]===i.index&&m[v]++}return f===a[b]?!c&&m.test("")||l.push(""):l.push(a.slice(f)),l[b]>p?l.slice(0,p):l}:"0"[p](void 0,0)[b]?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,n){var a=e(this),i=void 0==t?void 0:t[r];return void 0!==i?i.call(t,a,n):g.call(String(a),t,n)},function(e,r){var n=s(g,e,this,r,g!==t);if(n.done)return n.value;var u=a(e),d=String(this),p=i(u,RegExp),b=u.unicode,v=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(m?"y":"g"),O=new p(m?u:"^(?:"+u.source+")",v),y=void 0===r?h:r>>>0;if(0===y)return[];if(0===d.length)return null===l(O,d)?[d]:[];var P=0,j=0,I=[];while(j<d.length){O.lastIndex=m?j:0;var S,x=l(O,m?d:d.slice(j));if(null===x||(S=f(c(O.lastIndex+(m?0:j)),d.length))===P)j=o(d,j,b);else{if(I.push(d.slice(P,j)),I.length===y)return I;for(var A=1;A<=x.length-1;A++)if(I.push(x[A]),I.length===y)return I;j=P=S}}return I.push(d.slice(P)),I}]}))},"348f":function(e,r,t){"use strict";t.d(r,"b",(function(){return P})),t.d(r,"c",(function(){return d})),t.d(r,"d",(function(){return j})),t.d(r,"a",(function(){return I}));t("4f37"),t("6762"),t("2fdb"),t("28a5");function n(e){if(Array.isArray(e))return e}function a(e,r){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var t=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done);n=!0)if(t.push(o.value),r&&t.length===r)break}catch(l){a=!0,i=l}finally{try{n||null==c["return"]||c["return"]()}finally{if(a)throw i}}return t}}var i=t("06c5");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,r){return n(e)||a(e,r)||Object(i["a"])(e,r)||o()}var l=t("4360"),u=t("0a94"),s=t("9429"),f=t("eaf8");function d(e,r,t,n){var a=Object(f["c"])({periodo:n||null,Plano:t||null,letra:e[r.letra]||null});return a.letra?(p(a,e[r.disciplinaCod]),a.Disciplina?(b(a,e[r.horarioESala]),a.turno1?(v(a,e[r.docentes]),a):null):null):null}function p(e,r){if(r){var t=Object(u["a"])(l["a"].getters.AllDisciplinas,["codigo",r]);t?(e.Disciplina=t.id,e.creditoTotal=t.creditoTotal):e.Disciplina=null}}function b(e,r){if(r){var t=r.split(";"),n=c(t,2),a=n[0],i=n[1];e.Horario1=g(a),e.creditoTotal>=4&&(e.Horario2=g(i)),e.turno1=h(e.Horario1,e.Horario2),"EAD"!==e.turno1&&(e.Sala1=y(a),e.Sala2=y(i))}}function v(e,r){if(r){var t=r.split(";"),n=c(t,2),a=n[0],i=n[1];e.Docente1=m(a),e.Docente2=m(i)}}function h(e,r){return e||r?31===e?"EAD":Object(s["a"])(l["a"].getters.HorariosNoturno,["id",e])||Object(s["a"])(l["a"].getters.HorariosNoturno,["id",r])?"Noturno":"Diurno":null}function m(e){if(!e)return null;var r=Object(u["a"])(l["a"].getters.AllDocentes,(function(r){return Object(f["f"])(r.nome)===Object(f["f"])(e)}));return r?r.id:null}function g(e){if(!e)return null;var r=e.split(","),t=c(r,3),n=t[0],a=t[1],i=t[2],o=O(n,a);if(o){var s=Object(u["a"])(l["a"].getters.AllHorarios,["horario",o]);return s?s.id:null}return i.includes("EAD")?31:null}function O(e,r){if(!e||!r)return null;var t=null;switch(e.trim().substring(0,3)){case"SEG":t="2a";break;case"TER":t="3a";break;case"QUA":t="4a";break;case"QUI":t="5a";break;case"SEX":t="6a";break;case"SAB":return"EAD";default:return null}var n=r.split("AS"),a=c(n,2),i=a[0],o=a[1];if(!i||!o)return null;var l=i.trim().substring(0,2),u=o.trim().substring(0,2);return"".concat(t," ").concat(l,"-").concat(u)}function y(e){if(!e)return null;var r=e.split(","),t=c(r,3),n=t[2],a=Object(f["f"])(n),i=Object(u["a"])(l["a"].getters.AllSalas,(function(e){var r=Object(f["f"])(e.nome);return a.includes(r)}));return i?i.id:null}function P(e,r,t){var n={Turma:null,Curso:null,vagasOferecidas:0,vagasOcupadas:0},a=Object(u["a"])(l["a"].getters.AllCursos,["codigo",e[r.cursoCod]]);return n.Curso=a?a.id:null,n.Turma=t,n.vagasOferecidas=parseInt(e[r.vagas1],10),n.vagasOcupadas=parseInt(e[r.vagas2],10),n.Curso?n:null}t("ac6a"),t("456d");function j(e){if(e.length){var r=["DISCIPLINA","DISCIPLINA_COD.","TURMA","CURSO_COD.","CURSO","VAGASOFERECIDAS","VAGASOCUPADAS","HORARIOS","DOCENTES"];if(Object.keys(e[0]).length<r.length)throw new Error("Verifique a integridade e o formato do(s) arquivo(s)")}}function I(e){var r={disciplinaCod:null,letra:null,cursoCod:null,vagas1:null,vagas2:null,horarioESala:null,docentes:null},t=0;for(var n in e){if(1===t)r.disciplinaCod=n;else if(2===t)r.letra=n;else if(3===t)r.cursoCod=n;else if(5===t)r.vagas1=n;else if(6===t)r.vagas2=n;else if(7===t)r.horarioESala=n;else if(8===t){r.docentes=n;break}t++}return r}},"9ae6":function(e,r,t){"use strict";t.r(r);var n=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e._m(0),t("div",{staticClass:"row"},[t("div",{staticClass:"col"},[t("VInputFile",{attrs:{label:"Primeiro período",validation:e.$v.form.file1Periodo,accept:".csv"},model:{value:e.form.file1Periodo,callback:function(r){e.$set(e.form,"file1Periodo",r)},expression:"form.file1Periodo"}})],1),t("div",{staticClass:"col"},[t("VInputFile",{attrs:{label:"Terceiro período",validation:e.$v.form.file3Periodo,accept:".csv"},model:{value:e.form.file3Periodo,callback:function(r){e.$set(e.form,"file3Periodo",r)},expression:"form.file3Periodo"}})],1)]),t("portal",{attrs:{to:"loading-content"}},[t("BaseButton",{staticClass:"paddingX-20",attrs:{color:"gray",text:"Cancelar",disable:e.abortImport},on:{click:function(r){e.abortImport=!0,e.closeModal()}}})],1)],1)},a=[function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("p",{staticClass:"alert alert-secondary"},[e._v("\n    Selecione arquivos\n    "),t("b",[e._v(".csv")]),e._v("\n    para importar as turmas de cada periodo do novo plano. Note que o formato do arquivo requerido\n    é o relatorio de plano departamental gerado pelo\n    "),t("a",{attrs:{href:"https://siga.ufjf.br",target:"_blank"}},[e._v("SIGA")]),e._v("\n    na página:\n    "),t("b",[e._v("Acadêmico > Consultas > Plano Departamental")]),e._v("\n    . E você pode cancelar o processo durante a importação apertando a tecla esc.\n  ")])}],i=(t("2caf"),t("ac4d"),t("8a81"),t("5df3"),t("1c4c"),t("7f7f"),t("6b54"),t("87b3"),t("1c01"),t("58b2"),t("8e6e"),t("f3e2"),t("d25f"),t("ac6a"),t("456d"),t("96cf"),t("1da1")),o=t("ade3"),c=t("2f62"),l=t("b5ae"),u=t("eaf8"),s=t("348f"),f=t("25df");function d(e,r){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=p(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==t.return||t.return()}finally{if(c)throw i}}}}function p(e,r){if(e){if("string"===typeof e)return b(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?b(e,r):void 0}}function b(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function v(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?v(Object(t),!0).forEach((function(r){Object(o["a"])(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var m={name:"ModalImportPlano",components:{VInputFile:f["j"]},props:{plano:{type:Object,required:!0},closeModal:{type:Function,required:!0}},data:function(){return{abortImport:!1,form:{file1Periodo:null,file3Periodo:null}}},validations:{form:{file1Periodo:{requiredIf:Object(l["requiredIf"])((function(){return!this.form.file3Periodo}))},file3Periodo:{requiredIf:Object(l["requiredIf"])((function(){return!this.form.file1Periodo}))}}},mounted:function(){var e=this;document.addEventListener("keydown",(function(r){r.stopPropagation(),"Escape"===r.code&&(e.abortImport=!0)}))},methods:h(h({},Object(c["b"])(["createPlano","deletePlano","createTurma","createPedidoSIGA","initializeProgressBar","updateProgressBar","finishProgressBar"])),{},{handleImportPlano:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var r,t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.form.$touch(),!this.$v.form.$anyError){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,this.abortImport=!1,e.next=7,Object(u["g"])(this.form.file1Periodo);case 7:return r=e.sent,e.next=10,Object(u["g"])(this.form.file3Periodo);case 10:return t=e.sent,Object(s["d"])(r),Object(s["d"])(t),this.initializeProgressBar({finalValue:r.length+t.length}),e.next=16,this.createPlano({data:this.plano});case 16:return n=e.sent,e.next=19,this.createTurmasFileSIGA(r,n,1);case 19:return e.next=21,this.createTurmasFileSIGA(t,n,3);case 21:this.abortImport?this.pushNotification({type:"warn",text:"Importação do plano foi cancelada"}):(this.closeModal(),this.pushNotification({type:"success",text:"Plano criado e turmas importadas"})),e.next=27;break;case 24:e.prev=24,e.t0=e["catch"](3),this.pushNotification({type:"error",title:"Erro ao criar plano!",text:e.t0.message});case 27:return e.prev=27,e.next=30,this.finishProgressBar();case 30:return e.finish(27);case 31:case"end":return e.stop()}}),e,this,[[3,24,27,31]])})));function r(){return e.apply(this,arguments)}return r}(),createTurmasFileSIGA:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(r,t,n){var a,i,o,c,l,u,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r.length){e.next=2;break}return e.abrupt("return");case 2:a={},i=Object(s["a"])(r[0]),o=d(r),e.prev=5,o.s();case 7:if((c=o.n()).done){e.next=29;break}if(l=c.value,!this.abortImport){e.next=12;break}return this.deletePlano({data:h({},t)}),e.abrupt("break",29);case 12:if(this.updateProgressBar(),u=Object(s["c"])(l,i,t.id,n),u){e.next=16;break}return e.abrupt("continue",27);case 16:if(!this.turmasIsEqual(a,u)){e.next=21;break}return e.next=19,this.handleCreatePedidoSIGA(l,i,a.id);case 19:e.next=27;break;case 21:return e.next=23,this.createTurma({data:u});case 23:return f=e.sent,e.next=26,this.handleCreatePedidoSIGA(l,i,f.id);case 26:a=h({},f);case 27:e.next=7;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e["catch"](5),o.e(e.t0);case 34:return e.prev=34,o.f(),e.finish(34);case 37:case"end":return e.stop()}}),e,this,[[5,31,34,37]])})));function r(r,t,n){return e.apply(this,arguments)}return r}(),handleCreatePedidoSIGA:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(r,t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=Object(s["b"])(r,t,n),!a){e.next=4;break}return e.next=4,this.createPedidoSIGA({data:a}).catch((function(){}));case 4:case"end":return e.stop()}}),e,this)})));function r(r,t,n){return e.apply(this,arguments)}return r}(),turmasIsEqual:function(e,r){return e.letra===r.letra&&e.Disciplina===r.Disciplina}})},g=m,O=(t("0bad"),t("2877")),y=Object(O["a"])(g,n,a,!1,null,"6e79f9c9",null);r["default"]=y.exports},af8d:function(e,r,t){}}]);
//# sourceMappingURL=chunk-2d687ec1.8709dc21.js.map