{"version":3,"sources":["webpack:///./src/pages/gerenciar/DisciplinasGrades/ModalImportacao.vue?0196","webpack:///src/pages/gerenciar/DisciplinasGrades/ModalImportacao.vue","webpack:///./src/pages/gerenciar/DisciplinasGrades/ModalImportacao.vue?1808","webpack:///./src/pages/gerenciar/DisciplinasGrades/ModalImportacao.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","attrs","scopedSlots","_u","key","fn","staticClass","on","handleSelectCurso","model","value","callback","$$v","cursoSelecionado","expression","_l","curso","codigo","nome","hasCursoSelected","gradeSelecionada","grade","id","_v","fileImportacao","proxy","handleImport","staticRenderFns","components","data","gradesCursoSelecionado","methods","handleCreateDisciplinasNaGrade","disciplinaGrade","discsGradeSelecionada","length","periodo","Disciplina","disciplina","Grade","obrigatoria","objDiscGrade","PERIODO","getIdDisciplina","CODIGO","disciplinaFound","OBRIGATORIA","checkDiscGradeExiste","open","$refs","BaseModalDisciplinaGrade","close","AllGrades","filter","Curso","AllDisciplinas","find","computed","cursosDCCOrdered","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,YAAY,CAACE,IAAI,2BAA2BC,MAAM,CAAC,MAAQ,qCAAqC,YAAa,EAAK,WAAY,GAAMC,YAAYR,EAAIS,GAAG,CAAC,CAACC,IAAI,aAAaC,GAAG,WAAW,MAAO,CAACP,EAAG,MAAM,CAACQ,YAAY,OAAO,CAACR,EAAG,UAAU,CAACQ,YAAY,QAAQL,MAAM,CAAC,MAAQ,SAASM,GAAG,CAAC,OAASb,EAAIc,mBAAmBC,MAAM,CAACC,MAAOhB,EAAoB,iBAAEiB,SAAS,SAAUC,GAAMlB,EAAImB,iBAAiBD,GAAKE,WAAW,qBAAqBpB,EAAIqB,GAAIrB,EAAoB,kBAAE,SAASsB,GAAO,OAAOlB,EAAG,UAAU,CAACM,IAAIY,EAAMC,OAAOhB,MAAM,CAAC,MAAQe,EAAM,KAAOA,EAAME,WAAU,GAAGpB,EAAG,UAAU,CAACQ,YAAY,QAAQL,MAAM,CAAC,MAAQ,QAAQ,UAAYP,EAAIyB,kBAAkBV,MAAM,CAACC,MAAOhB,EAAoB,iBAAEiB,SAAS,SAAUC,GAAMlB,EAAI0B,iBAAiBR,GAAKE,WAAW,qBAAqB,CAAGpB,EAAIyB,iBAA4EzB,EAAIqB,GAAIrB,EAA0B,wBAAE,SAAS2B,GAAO,OAAOvB,EAAG,UAAU,CAACM,IAAIiB,EAAMC,GAAGrB,MAAM,CAAC,MAAQoB,EAAM,KAAOA,EAAMH,WAAlLpB,EAAG,UAAU,CAACG,MAAM,CAAC,KAAO,+BAAiK,IAAI,GAAGH,EAAG,IAAI,CAACQ,YAAY,8BAA8B,CAACZ,EAAI6B,GAAG,qGAAqGzB,EAAG,MAAMJ,EAAI6B,GAAG,oEAAoEzB,EAAG,MAAM,CAACQ,YAAY,OAAO,CAACR,EAAG,aAAa,CAACG,MAAM,CAAC,MAAQ,sBAAsB,OAAS,QAAQQ,MAAM,CAACC,MAAOhB,EAAkB,eAAEiB,SAAS,SAAUC,GAAMlB,EAAI8B,eAAeZ,GAAKE,WAAW,qBAAqB,KAAKW,OAAM,GAAM,CAACrB,IAAI,eAAeC,GAAG,WAAW,MAAO,CAACP,EAAG,aAAa,CAACQ,YAAY,eAAeL,MAAM,CAAC,KAAO,KAAK,MAAQ,SAASM,GAAG,CAAC,MAAQb,EAAIgC,kBAAkBD,OAAM,QAClsDE,EAAkB,G,s1DCsDtB,OACEC,WAAY,CAAd,iDACEC,KAFF,WAGI,MAAO,CACLL,eAAgB,KAEhBX,iBAAkB,KAClBiB,uBAAwB,KACxBV,iBAAkB,OAItBW,QAAS,EAAX,KACA,gBACA,wBACA,oBACA,oBACA,4BALA,IAOI,aAPJ,qMASA,oCATA,OASA,EATA,OAUA,kBAEA,4BACA,sBAGA,6CACA,iCAjBA,IAmBA,GAnBA,IAmBA,qCACA,yCApBA,8BAuBA,uBACA,eACA,sCAzBA,qDA4BA,uBACA,aACA,iDACA,oBA/BA,yBAkCA,aAlCA,UAmCA,yBAnCA,oJAsCIC,+BAtCJ,SAsCA,KACM,GAAKC,GAAoBC,EAAsBC,OAA/C,CAEA,IAAN,GACQC,QAAS,KACTC,WAAY,KACZC,WAAY,KACZC,MAAO,KACPC,aAAa,GAGfC,EAAaF,MAAQ5C,KAAKyB,iBAAiBE,GACZ,KAA3BW,EAAgBS,QAAgBD,EAAaL,QAAU,GACjE,qBAEMK,EAAaJ,WAAa1C,KAAKgD,gBAAgBV,EAAgBW,QAC/DH,EAAaH,WAAa3C,KAAKkD,gBAAgBJ,EAAaJ,YAC5DI,EAAaD,aAAeP,EAAgBa,YAEL,kBAA5BL,EAAaJ,YAC9B,mCAEI,uBA5DJ,oEA4DA,KA5DA,0FA6DA,kCAEA,EA/DA,gCAgEA,cACA,aACA,QACA,GAnEA,6CAqEA,iBArEA,OAuEA,yBAvEA,2GAyEIU,qBAzEJ,SAyEA,eACA,GADA,IACA,0CACA,yCAFA,8BAIM,OAAO,GAETC,KA/EJ,WAgFMrD,KAAKsD,MAAMC,yBAAyBF,QAEtCG,MAlFJ,WAmFMxD,KAAKsD,MAAMC,yBAAyBC,SAEtC3C,kBArFJ,WAqFA,WACMb,KAAKmC,uBAAyBnC,KAAKyD,UAAUC,QAAO,SAA1D,GACQ,OAAOhC,EAAMiC,OAAS,EAA9B,wBAGIX,gBA1FJ,SA0FA,aACA,qBADA,IACA,sEADA,gCAGIE,gBA7FJ,SA6FA,GACM,OAAOlD,KAAK4D,eAAeC,MAAK,SAAtC,yBAIEC,SAAU,EAAZ,KACA,0FADA,IAEItC,iBAFJ,WAGM,OAAOxB,KAAKkB,kBAEd6C,iBALJ,WAMM,OAAO,OAAb,OAAa,CAAb,qCC3KuX,I,YCOnXC,EAAY,eACd,EACAlE,EACAkC,GACA,EACA,KACA,KACA,MAIa,aAAAgC,E","file":"js/chunk-2d21764f.43bfd05f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('BaseModal',{ref:\"BaseModalDisciplinaGrade\",attrs:{\"title\":\"Importação de Disciplinas na Grade\",\"hasOverlay\":true,\"hasFooter\":true},scopedSlots:_vm._u([{key:\"modal-body\",fn:function(){return [_c('div',{staticClass:\"row\"},[_c('VSelect',{staticClass:\"col-7\",attrs:{\"label\":\"Curso\"},on:{\"change\":_vm.handleSelectCurso},model:{value:(_vm.cursoSelecionado),callback:function ($$v) {_vm.cursoSelecionado=$$v},expression:\"cursoSelecionado\"}},_vm._l((_vm.cursosDCCOrdered),function(curso){return _c('VOption',{key:curso.codigo,attrs:{\"value\":curso,\"text\":curso.nome}})}),1),_c('VSelect',{staticClass:\"col-5\",attrs:{\"label\":\"Grade\",\"disabled\":!_vm.hasCursoSelected},model:{value:(_vm.gradeSelecionada),callback:function ($$v) {_vm.gradeSelecionada=$$v},expression:\"gradeSelecionada\"}},[(!_vm.hasCursoSelected)?_c('VOption',{attrs:{\"text\":\"Nenhuma grade encontrada\"}}):_vm._l((_vm.gradesCursoSelecionado),function(grade){return _c('VOption',{key:grade.id,attrs:{\"value\":grade,\"text\":grade.nome}})})],2)],1),_c('p',{staticClass:\"alert alert-secondary my-2\"},[_vm._v(\"\\n      Selecione o curso e a sua grade acima e o arquivo a ser importado. O arquivo deve\\n      \"),_c('br'),_vm._v(\"\\n      ser importado de acordo com a grade selecionada.\\n    \")]),_c('div',{staticClass:\"col\"},[_c('VInputFile',{attrs:{\"label\":\"Selecione o arquivo\",\"accept\":\".csv\"},model:{value:(_vm.fileImportacao),callback:function ($$v) {_vm.fileImportacao=$$v},expression:\"fileImportacao\"}})],1)]},proxy:true},{key:\"modal-footer\",fn:function(){return [_c('BaseButton',{staticClass:\"px-3 ml-auto\",attrs:{\"text\":\"OK\",\"color\":\"green\"},on:{\"click\":_vm.handleImport}})]},proxy:true}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <BaseModal\n    ref=\"BaseModalDisciplinaGrade\"\n    title=\"Importação de Disciplinas na Grade\"\n    :hasOverlay=\"true\"\n    :hasFooter=\"true\"\n  >\n    <template #modal-body>\n      <div class=\"row\">\n        <VSelect label=\"Curso\" v-model=\"cursoSelecionado\" class=\"col-7\" @change=\"handleSelectCurso\">\n          <VOption\n            v-for=\"curso in cursosDCCOrdered\"\n            :key=\"curso.codigo\"\n            :value=\"curso\"\n            :text=\"curso.nome\"\n          />\n        </VSelect>\n        <VSelect\n          label=\"Grade\"\n          v-model=\"gradeSelecionada\"\n          class=\"col-5\"\n          :disabled=\"!hasCursoSelected\"\n        >\n          <VOption v-if=\"!hasCursoSelected\" text=\"Nenhuma grade encontrada\" />\n          <VOption\n            v-else\n            v-for=\"grade in gradesCursoSelecionado\"\n            :key=\"grade.id\"\n            :value=\"grade\"\n            :text=\"grade.nome\"\n          />\n        </VSelect>\n      </div>\n      <p class=\"alert alert-secondary my-2\">\n        Selecione o curso e a sua grade acima e o arquivo a ser importado. O arquivo deve\n        <br />\n        ser importado de acordo com a grade selecionada.\n      </p>\n      <div class=\"col\">\n        <VInputFile label=\"Selecione o arquivo\" v-model=\"fileImportacao\" accept=\".csv\" />\n      </div>\n    </template>\n    <template #modal-footer>\n      <BaseButton text=\"OK\" color=\"green\" class=\"px-3 ml-auto\" @click=\"handleImport\" />\n    </template>\n  </BaseModal>\n</template>\n\n<script>\nimport { VInputFile, VSelect, VOption } from \"@/components/ui\";\nimport { parseCSVFileToArray, validateDisciplinasGrades } from \"@/common/utils\";\nimport { mapActions, mapGetters } from \"vuex\";\nimport disciplinaGradeService from \"@/services/disciplinaGrade\";\nimport { orderBy } from \"lodash-es\";\n\nexport default {\n  components: { VInputFile, VSelect, VOption },\n  data() {\n    return {\n      fileImportacao: null,\n\n      cursoSelecionado: null,\n      gradesCursoSelecionado: null,\n      gradeSelecionada: null,\n    };\n  },\n\n  methods: {\n    ...mapActions([\n      \"initializeProgressBar\",\n      \"updateProgressBar\",\n      \"finishProgressBar\",\n      \"createDisciplinasGrade\",\n    ]),\n    async handleImport() {\n      try {\n        const disciplinasGrades = await parseCSVFileToArray(this.fileImportacao);\n        validateDisciplinasGrades(disciplinasGrades);\n\n        this.initializeProgressBar({\n          finalValue: disciplinasGrades.length,\n        });\n\n        const disciplinasGradeSelecionada = this.DisciplinasGrades.filter((disc) => {\n          disc.Grade === this.gradeSelecionada.id;\n        });\n        for (const discGrade of disciplinasGrades) {\n          this.handleCreateDisciplinasNaGrade(discGrade, disciplinasGradeSelecionada);\n        }\n\n        this.pushNotification({\n          type: \"success\",\n          text: \"Disciplinas criadas na Grade\",\n        });\n      } catch (error) {\n        this.pushNotification({\n          type: \"error\",\n          title: \"Erro ao importar disciplinas nas grades!\",\n          text: error.message,\n        });\n      } finally {\n        this.close(); // O modal fecha de qualquer jeito por causa do esc\n        await this.finishProgressBar();\n      }\n    },\n    handleCreateDisciplinasNaGrade(disciplinaGrade, discsGradeSelecionada) {\n      if (!disciplinaGrade || !discsGradeSelecionada.length) return;\n\n      let objDiscGrade = {\n        periodo: null,\n        Disciplina: null,\n        disciplina: null,\n        Grade: null,\n        obrigatoria: false,\n      };\n\n      objDiscGrade.Grade = this.gradeSelecionada.id;\n      if (disciplinaGrade.PERIODO == \"-\") objDiscGrade.periodo = 15;\n      else objDiscGrade.periodo = +disciplinaGrade.PERIODO;\n\n      objDiscGrade.Disciplina = this.getIdDisciplina(disciplinaGrade.CODIGO);\n      objDiscGrade.disciplina = this.disciplinaFound(objDiscGrade.Disciplina);\n      objDiscGrade.obrigatoria = +disciplinaGrade.OBRIGATORIA;\n\n      if (typeof objDiscGrade.Disciplina === \"number\")\n        this.createDisciplinasGrade(objDiscGrade, discsGradeSelecionada);\n    },\n    async createDisciplinasGrade(disciplinaGrade, disciplinasGradeSelecionada) {\n      const temDisciplina = this.checkDiscGradeExiste(disciplinaGrade, disciplinasGradeSelecionada);\n\n      if (temDisciplina)\n        await disciplinaGradeService.update(\n          disciplinaGrade.Disciplina,\n          disciplinaGrade.Grade,\n          disciplinaGrade\n        );\n      else await disciplinaGradeService.create(disciplinaGrade);\n\n      this.updateProgressBar();\n    },\n    checkDiscGradeExiste(disciplinaGrade, disciplinasGradeSelecionada) {\n      for (const disc of disciplinasGradeSelecionada) {\n        if (disciplinaGrade.Disciplina === disc.Disciplina) return true;\n      }\n      return false;\n    },\n    open() {\n      this.$refs.BaseModalDisciplinaGrade.open();\n    },\n    close() {\n      this.$refs.BaseModalDisciplinaGrade.close();\n    },\n    handleSelectCurso() {\n      this.gradesCursoSelecionado = this.AllGrades.filter((grade) => {\n        return grade.Curso == this.cursoSelecionado.id;\n      });\n    },\n    getIdDisciplina(codigoDisc) {\n      for (const disc of this.AllDisciplinas) if (disc.codigo == codigoDisc) return disc.id;\n    },\n    disciplinaFound(idDisciplina) {\n      return this.AllDisciplinas.find((disciplina) => disciplina.id === idDisciplina);\n    },\n  },\n\n  computed: {\n    ...mapGetters([\"PrincipaisCursosDCC\", \"AllDisciplinas\", \"AllGrades\", \"DisciplinasGrades\"]),\n    hasCursoSelected() {\n      return this.cursoSelecionado;\n    },\n    cursosDCCOrdered() {\n      return orderBy(this.PrincipaisCursosDCC, \"name\");\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModalImportacao.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModalImportacao.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ModalImportacao.vue?vue&type=template&id=5ea53198&\"\nimport script from \"./ModalImportacao.vue?vue&type=script&lang=js&\"\nexport * from \"./ModalImportacao.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}