(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c1997"],{4775:function(i,e,r){"use strict";r.r(e);var a=function(){var i=this,e=i.$createElement,r=i._self._c||e;return r("div",[r("p",{staticClass:"alert alert-secondary"},[i._v("\n    Selecione as disciplinas para quais as turmas do atual plano\n    "),r("b",[i._v(i._s(i.currentPlano.nome+" - "+i.currentPlano.ano))]),i._v("\n    serão copiadas para o novo plano.\n  ")]),r("div",{staticClass:"div-table"},[r("BaseTable",{attrs:{type:"modal",hasSearchBar:!0,styles:"max-height:500px; height:500px"},scopedSlots:i._u([{key:"thead-search",fn:function(){return[r("InputSearch",{attrs:{placeholder:"Pesquise nome ou codigo de uma disciplina..."},model:{value:i.searchDisciplinasModal,callback:function(e){i.searchDisciplinasModal=e},expression:"searchDisciplinasModal"}})]},proxy:!0},{key:"thead",fn:function(){return[r("v-th",{attrs:{width:"25"}}),r("v-th-ordination",{attrs:{currentOrder:i.ordenacaoModal.disciplinas,orderToCheck:"codigo",width:"80",align:"start"}},[i._v("\n          Código\n        ")]),r("v-th-ordination",{attrs:{currentOrder:i.ordenacaoModal.disciplinas,orderToCheck:"nome",width:"260",align:"start"}},[i._v("\n          Nome\n        ")]),r("v-th-ordination",{attrs:{currentOrder:i.ordenacaoModal.disciplinas,orderToCheck:"perfil.abreviacao",width:"85",align:"start"}},[i._v("\n          Perfil\n        ")])]},proxy:!0},{key:"tbody",fn:function(){return[i._l(i.DisciplinasOrderedModal,(function(e){return r("tr",{directives:[{name:"prevent-click-selection",rawName:"v-prevent-click-selection"}],key:e.id,on:{click:function(r){return i.toggleItemInArray(e.id,i.filtrosDisciplinas)}}},[r("v-td",{attrs:{width:"25",type:"content"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:i.filtrosDisciplinas,expression:"filtrosDisciplinas"}],attrs:{type:"checkbox"},domProps:{value:e.id,checked:Array.isArray(i.filtrosDisciplinas)?i._i(i.filtrosDisciplinas,e.id)>-1:i.filtrosDisciplinas},on:{change:function(r){var a=i.filtrosDisciplinas,s=r.target,o=!!s.checked;if(Array.isArray(a)){var t=e.id,n=i._i(a,t);s.checked?n<0&&(i.filtrosDisciplinas=a.concat([t])):n>-1&&(i.filtrosDisciplinas=a.slice(0,n).concat(a.slice(n+1)))}else i.filtrosDisciplinas=o}}})]),r("v-td",{attrs:{width:"80",align:"start"}},[i._v(i._s(e.codigo))]),r("v-td",{attrs:{width:"260",align:"start",title:e.nome}},[i._v("\n            "+i._s(e.nome)+"\n          ")]),r("v-td",{attrs:{width:"85",align:"start"}},[i._v(i._s(e.perfil.abreviacao))])],1)})),i.DisciplinasOrderedModal.length?i._e():r("tr",[r("v-td",{attrs:{colspan:"3",width:"450"}},[i._v("NENHUMA DISCIPLINA ENCONTRADA.")])],1)]},proxy:!0}])})],1)])},s=[],o=(r("1c01"),r("58b2"),r("8e6e"),r("456d"),r("4917"),r("ade3")),t=(r("6762"),r("2fdb"),r("ac6a"),r("f3e2"),r("7514"),r("d25f"),r("6d67"),r("2f62")),n=r("ebd8"),d=r("456a"),c=r("7ed3"),l=r("5bdd"),p=r("16ba"),u=r("eaf8"),f=r("9165"),C=r("25df"),h=r("9ae6");function D(i,e){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),r.push.apply(r,a)}return r}function v(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?D(Object(r),!0).forEach((function(e){Object(o["a"])(i,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))}))}return i}var m={name:"ModalNovoPlano",mixins:[f["n"],f["l"]],components:{InputSearch:C["d"],ImportPlano:h["default"]},props:{plano:{type:Object,required:!0}},data:function(){return{searchDisciplinasModal:"",filtrosDisciplinas:[],ordenacaoModal:{disciplinas:{order:"codigo",type:"asc"}},grades1semestre:{CCD:[],CCN:[],EC:[],SI:[]},grades2semestre:{CCD:[],CCN:[],EC:[],SI:[]}}},methods:{open:function(){this.$refs.baseModalNovoPlano.open()},close:function(){this.$refs.baseModalNovoPlano.close()},selectAllDisciplinas:function(){this.filtrosDisciplinas=this.$_.union(this.filtrosDisciplinas,this.$_.map(this.DisciplinasFiltredModal,"id"))},selectNoneDisciplinas:function(){this.filtrosDisciplinas=this.$_.difference(this.filtrosDisciplinas,this.$_.map(this.DisciplinasFiltredModal,"id"))},gradesAtivas:function(i){var e,r,a;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",4]),e=this.$_.orderBy(e,"periodoInicio","desc"),a=0;for(var s=0;s<e.length;s++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[s].periodoInicio.slice(0,4),10))+(1-parseInt(e[s].periodoInicio.slice(5,6),10))/2,this.grades1semestre.CCD.push({id:e[s].id,inicio:r,fim:a}),a>9)break;a=0;for(var o=0;o<e.length;o++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[o].periodoInicio.slice(0,4),10))+(3-parseInt(e[o].periodoInicio.slice(5,6),10))/2,this.grades2semestre.CCD.push({id:e[o].id,inicio:r,fim:a}),a>9)break;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",1]),e=this.$_.orderBy(e,"periodoInicio","desc"),a=0;for(var t=0;t<e.length;t++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[t].periodoInicio.slice(0,4),10))+(1-parseInt(e[t].periodoInicio.slice(5,6),10))/2,this.grades1semestre.CCN.push({id:e[t].id,inicio:r,fim:a}),a>9)break;a=0;for(var n=0;n<e.length;n++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[n].periodoInicio.slice(0,4),10))+(3-parseInt(e[n].periodoInicio.slice(5,6),10))/2,this.grades2semestre.CCN.push({id:e[n].id,inicio:r,fim:a}),a>9)break;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",3]),e=this.$_.orderBy(e,"periodoInicio","desc"),a=0;for(var d=0;d<e.length;d++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[d].periodoInicio.slice(0,4),10))+(1-parseInt(e[d].periodoInicio.slice(5,6),10))/2,this.grades1semestre.SI.push({id:e[d].id,inicio:r,fim:a}),a>9)break;a=0;for(var c=0;c<e.length;c++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[c].periodoInicio.slice(0,4),10))+(3-parseInt(e[c].periodoInicio.slice(5,6),10))/2,this.grades2semestre.SI.push({id:e[c].id,inicio:r,fim:a}),a>9)break;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",2]),e=this.$_.orderBy(e,"periodoInicio","desc"),a=0;for(var l=0;l<e.length;l++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[l].periodoInicio.slice(0,4),10))+(1-parseInt(e[l].periodoInicio.slice(5,6),10))/2,this.grades1semestre.EC.push({id:e[l].id,inicio:r,fim:a}),a>9)break;a=0;for(var p=0;p<e.length;p++)if(r=a+1,a=1+2*(parseInt(i,10)-parseInt(e[p].periodoInicio.slice(0,4),10))+(3-parseInt(e[p].periodoInicio.slice(5,6),10))/2,this.grades2semestre.EC.push({id:e[p].id,inicio:r,fim:a}),a>9)break},generateTurmasNovoPlano:function(){var i=this;this.gradesAtivas(this.plano.ano);for(var e=[],r=[],a=function(r){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.CCD[r].id});a.forEach((function(a){if(a.periodo%2===1&&a.periodo>=i.grades1semestre.CCD[r].inicio&&a.periodo<=i.grades1semestre.CCD[r].fim){var s=i.$_.find(e,{Disciplina:a.Disciplina});void 0===s?e.push({Disciplina:a.Disciplina,CCD:!0,EC:!1,CCN:!1,SI:!1,periodo:1}):s.CCD=!0}}))},s=0;s<this.grades1semestre.CCD.length;s++)a(s);for(var o=function(r){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.EC[r].id});a.forEach((function(a){if(a.periodo%2===1&&a.periodo>=i.grades1semestre.EC[r].inicio&&a.periodo<=i.grades1semestre.EC[r].fim){var s=i.$_.find(e,{Disciplina:a.Disciplina});void 0===s?e.push({Disciplina:a.Disciplina,CCD:!1,EC:!0,CCN:!1,SI:!1,periodo:1}):s.EC=!0}}))},t=0;t<this.grades1semestre.EC.length;t++)o(t);for(var n=function(r){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.CCN[r].id});a.forEach((function(a){if(a.periodo%2===0&&a.periodo>=i.grades1semestre.CCN[r].inicio&&a.periodo<=i.grades1semestre.CCN[r].fim){var s=i.$_.find(e,{Disciplina:a.Disciplina});void 0===s?e.push({Disciplina:a.Disciplina,CCD:!1,EC:!1,CCN:!0,SI:!1,periodo:1}):s.CCN=!0}}))},d=0;d<this.grades1semestre.CCN.length;d++)n(d);for(var c=function(r){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.SI[r].id});a.forEach((function(a){if(a.periodo%2===0&&a.periodo>=i.grades1semestre.SI[r].inicio&&a.periodo<=i.grades1semestre.SI[r].fim){var s=i.$_.find(e,{Disciplina:a.Disciplina});void 0===s?e.push({Disciplina:a.Disciplina,CCD:!1,EC:!1,CCN:!1,SI:!0,periodo:1}):s.SI=!0}}))},l=0;l<this.grades1semestre.SI.length;l++)c(l);for(var p=function(e){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.CCD[e].id});a.forEach((function(a){if(a.periodo%2===0&&a.periodo>=i.grades2semestre.CCD[e].inicio&&a.periodo<=i.grades2semestre.CCD[e].fim){var s=i.$_.find(r,{Disciplina:a.Disciplina});void 0===s?r.push({Disciplina:a.Disciplina,CCD:!0,EC:!1,CCN:!1,SI:!1,periodo:3}):s.CCD=!0}}))},u=0;u<this.grades2semestre.CCD.length;u++)p(u);for(var f=function(e){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.EC[e].id});a.forEach((function(a){if(a.periodo%2===0&&a.periodo>=i.grades2semestre.EC[e].inicio&&a.periodo<=i.grades2semestre.EC[e].fim){var s=i.$_.find(r,{Disciplina:a.Disciplina});void 0===s?r.push({Disciplina:a.Disciplina,CCD:!1,EC:!0,CCN:!1,SI:!1,periodo:3}):s.EC=!0}}))},C=0;C<this.grades2semestre.EC.length;C++)f(C);for(var h=function(e){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.CCN[e].id});a.forEach((function(a){if(a.periodo%2===1&&a.periodo>=i.grades2semestre.CCN[e].inicio&&a.periodo<=i.grades2semestre.CCN[e].fim){var s=i.$_.find(r,{Disciplina:a.Disciplina});void 0===s?r.push({Disciplina:a.Disciplina,CCD:!1,EC:!1,CCN:!0,SI:!1,periodo:3}):s.CCN=!0}}))},D=0;D<this.grades2semestre.CCN.length;D++)h(D);for(var v=function(e){var a=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.SI[e].id});a.forEach((function(a){if(a.periodo%2===1&&a.periodo>=i.grades2semestre.SI[e].inicio&&a.periodo<=i.grades2semestre.SI[e].fim){var s=i.$_.find(r,{Disciplina:a.Disciplina});void 0===s?r.push({Disciplina:a.Disciplina,CCD:!1,EC:!1,CCN:!1,SI:!0,periodo:3}):s.SI=!0}}))},m=0;m<this.grades2semestre.SI.length;m++)v(m);e=this.$_.filter(e,(function(e){var r=i.$_.find(i.DisciplinasInPerfis,{id:e.Disciplina}).Perfil;return 13!==r&&15!==r})),r=this.$_.filter(r,(function(e){var r=i.$_.find(i.DisciplinasInPerfis,{id:e.Disciplina}).Perfil;return 13!==r&&15!==r}));var g=[];return e.forEach((function(e){i.$_.includes(i.filtrosDisciplinas,e.Disciplina)||((e.CCD||e.EC)&&(e.CCN||e.SI)?(g.push({semestre:1,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}),g.push({semestre:1,Disciplina:e.Disciplina,turno:"Noturno",letra:"B",CCN:e.CCN,SI:e.SI})):e.CCD||e.EC?g.push({semestre:1,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}):(e.CCN||e.SI)&&g.push({semestre:1,Disciplina:e.Disciplina,turno:"Noturno",letra:"A",CCN:e.CCN,SI:e.SI}))})),r.forEach((function(e){i.$_.includes(i.filtrosDisciplinas,e.Disciplina)||((e.CCD||e.EC)&&(e.CCN||e.SI)?(g.push({semestre:3,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}),g.push({semestre:3,Disciplina:e.Disciplina,turno:"Noturno",letra:"B",CCN:e.CCN,SI:e.SI})):e.CCD||e.EC?g.push({semestre:3,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}):(e.CCN||e.SI)&&g.push({semestre:3,Disciplina:e.Disciplina,turno:"Noturno",letra:"A",CCN:e.CCN,SI:e.SI}))})),g},handleCopyPlano:function(){var i=this;this.setPartialLoading(!0);var e=this.generateTurmasNovoPlano();n["a"].create(this.plano).then((function(r){e.forEach((function(i){d["a"].create({id:void 0,periodo:i.semestre,letra:i.letra,turno1:i.turno,turno2:void 0,Disciplina:i.Disciplina,Docente1:void 0,Docente2:void 0,Horario1:void 0,Horario2:void 0,Sala1:void 0,Sala2:void 0,Plano:r.Plano.id}).then((function(e){i.CCN&&c["a"].update(1,e.Turma.id,{Turma:e.Turma.id,Curso:1,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then((function(i){})).catch((function(i){console.log("erro ao atualizar pedido: "+i)})),i.EC&&c["a"].update(2,e.Turma.id,{Turma:e.Turma.id,Curso:2,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then((function(i){})).catch((function(i){console.log("erro ao atualizar pedido: "+i)})),i.SI&&c["a"].update(3,e.Turma.id,{Turma:e.Turma.id,Curso:3,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then((function(i){})).catch((function(i){console.log("erro ao atualizar pedido: "+i)})),i.CCD&&c["a"].update(4,e.Turma.id,{Turma:e.Turma.id,Curso:4,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then((function(i){})).catch((function(i){console.log("erro ao atualizar pedido: "+i)}))})).catch((function(i){console.log("erro ao criar turma: "+i)}))}));var a=i.$_.filter(i.$store.state.turma.Turmas,(function(e){var r=i.$_.includes(i.filtrosDisciplinas,e.Disciplina);return!!r}));a.forEach((function(e){d["a"].create({id:void 0,periodo:e.periodo,letra:e.letra,turno1:e.turno1,turno2:void 0,Disciplina:e.Disciplina,Horario1:e.Horario1,Horario2:e.Horario2,Sala1:void 0,Sala2:void 0,Plano:r.Plano.id}).then((function(r){var a=i.$store.state.pedido.Pedidos[e.id];a.forEach((function(i){c["a"].update(i.Curso,r.Turma.id,{Turma:r.Turma.id,Curso:i.Curso,vagasPeriodizadas:i.vagasPeriodizadas,vagasNaoPeriodizadas:0}).then((function(i){})).catch((function(i){console.log("erro ao atualizar pedido: "+i)}))}))})).catch((function(i){console.log("erro ao criar turma externa: "+i)}))})),i.$store.state.turmaExterna.Turmas.forEach((function(e){p["a"].create({id:void 0,periodo:e.periodo,letra:e.letra,turno1:e.turno1,turno2:void 0,Disciplina:e.Disciplina,Horario1:e.Horario1,Horario2:e.Horario2,Sala1:void 0,Sala2:void 0,Plano:r.Plano.id}).then((function(r){var a=i.$store.state.pedidoExterno.Pedidos[e.id];a.forEach((function(i){l["a"].update(i.Curso,r.Turma.id,{Turma:r.Turma.id,Curso:i.Curso,vagasPeriodizadas:i.vagasPeriodizadas,vagasNaoPeriodizadas:i.vagasNaoPeriodizadas}).then((function(i){})).catch((function(i){console.log("erro ao atualizar pedido externo: "+i)}))}))})).catch((function(i){console.log("erro ao criar turma externa: "+i)}))})),i.$store.dispatch("fetchAll").then((function(){setTimeout((function(){i.setPartialLoading(!1),i.close()}),300)}))}))}},computed:v(v({},Object(t["c"])(["DisciplinasInPerfis"])),{},{DisciplinasOrderedModal:function(){return this.$_.orderBy(this.DisciplinasFiltredModal,this.ordenacaoModal.disciplinas.order,this.ordenacaoModal.disciplinas.type)},DisciplinasFiltredModal:function(){if(""===this.searchDisciplinasModal)return this.DisciplinasInPerfis;var i=Object(u["c"])(this.searchDisciplinasModal);return this.$_.filter(this.DisciplinasInPerfis,(function(e){var r=Object(u["c"])(e.nome),a=Object(u["c"])(e.codigo);return r.match(i)||a.match(i)}))}})},g=m,I=r("2877"),N=Object(I["a"])(g,a,s,!1,null,null,null);e["default"]=N.exports}}]);
//# sourceMappingURL=chunk-2d0c1997.9409a31c.js.map