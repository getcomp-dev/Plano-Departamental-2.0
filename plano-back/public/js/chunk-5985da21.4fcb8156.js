(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5985da21"],{"469f":function(r,e,t){t("6c1c"),t("1654"),r.exports=t("7d7b")},"4f37":function(r,e,t){"use strict";t("aa77")("trim",function(r){return function(){return r(this,3)}})},"5d73":function(r,e,t){r.exports=t("469f")},"7d7b":function(r,e,t){var n=t("e4ae"),a=t("7cd6");r.exports=t("584a").getIterator=function(r){var e=a(r);if("function"!=typeof e)throw TypeError(r+" is not iterable!");return n(e.call(r))}},"9ae6":function(r,e,t){"use strict";t.r(e);var n=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",[r._m(0),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group col-4"},[t("label",{attrs:{for:"periodoPlano"}},[r._v("Período das turmas:")]),t("select",{directives:[{name:"model",rawName:"v-model.number",value:r.periodoTurmas,expression:"periodoTurmas",modifiers:{number:!0}}],staticClass:"form-control w-100",attrs:{id:"periodoPlano"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(r){return r.selected}).map(function(e){var t="_value"in e?e._value:e.value;return r._n(t)});r.periodoTurmas=e.target.multiple?t:t[0]}}},r._l(r.PeriodosLetivos,function(e){return t("option",{key:e.id+e.nome,domProps:{value:e.id}},[r._v("\n          "+r._s(e.nome)+"\n        ")])}),0)])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group col"},[t("input",{ref:"inputFilePlano",staticClass:"w-100 form-control-file",attrs:{type:"file"}})])])])},a=[function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("p",{staticClass:"alert alert-secondary"},[r._v("\n    Selecione um arquivo\n    "),t("b",[r._v(".csv")]),r._v("\n    para importar as turmas para o novo plano.\n  ")])}],i=(t("4f37"),t("6762"),t("2fdb"),t("7514"),t("759f"),t("28a5"),t("a745")),o=t.n(i);function s(r){if(o()(r))return r}var u=t("5d73"),l=t.n(u);function c(r,e){var t=[],n=!0,a=!1,i=void 0;try{for(var o,s=l()(r);!(n=(o=s.next()).done);n=!0)if(t.push(o.value),e&&t.length===e)break}catch(u){a=!0,i=u}finally{try{n||null==s["return"]||s["return"]()}finally{if(a)throw i}}return t}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function f(r,e){return s(r)||c(r,e)||d()}t("a481");var p=t("f499"),h=t.n(p),v=(t("96cf"),t("3b8d")),m=t("cebc"),b=t("2f62"),g=t("1146"),w=t.n(g),O=t("ebd8"),x=t("eaf8"),D={name:"ModalImportPlano",props:{plano:{type:Object,required:!0}},data:function(){return{periodoTurmas:null}},methods:Object(m["a"])({},Object(b["b"])(["createTurma","editPedido"]),{handleImportPlano:function(){var r=Object(v["a"])(regeneratorRuntime.mark(function r(){var e,t,n=this;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:this.setPartialLoading(!0),e=this.$refs.inputFilePlano.files[0],t=new FileReader,t.onload=function(){var r=Object(v["a"])(regeneratorRuntime.mark(function r(e){var t,a,i,o,s;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return t=w.a.read(e.target.result,{type:"binary"}),a=t.Sheets[t.SheetNames[0]],i=h()(w.a.utils.sheet_to_json(a)),o=i.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,""),s=JSON.parse(o),r.next=7,n.createPlanoImported(s,n.periodoTurmas);case 7:return r.next=9,n.$store.dispatch("fetchAll");case 9:n.setPartialLoading(!1);case 10:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),t.readAsBinaryString(e);case 5:case"end":return r.stop()}},r,this)}));function e(){return r.apply(this,arguments)}return e}(),createPlanoImported:function(){var r=Object(v["a"])(regeneratorRuntime.mark(function r(e){var t,n,a,i,o,s,u,c,d,p,h,v,b,g,w,D,_,y,C,k,H,P,S=arguments;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:for(i in t=S.length>1&&void 0!==S[1]?S[1]:1,n={disciplinaCod:null,letra:null,cursoCod:null,vagas1:null,vagas2:null,horarioESala:null,docentes:null},a=0,e[0])1===a?n.disciplinaCod=i:2===a?n.letra=i:3===a?n.cursoCod=i:5===a?n.vagas1=i:6===a?n.vagas2=i:7===a?n.horarioESala=i:8===a&&(n.docentes=i),a++;return o={},r.next=7,O["a"].create(this.plano);case 7:s=r.sent,u=!0,c=!1,d=void 0,r.prev=11,p=l()(e);case 13:if(u=(h=p.next()).done){r.next=33;break}if(v=h.value,b=Object(x["b"])(),b.Plano=s.Plano.id,b.periodo=t,b.letra=v[n.letra]||null,b.Disciplina=this.findDisciplinaId(v[n.disciplinaCod]),v[n.horarioESala]&&(g=v[n.horarioESala].split(";"),w=f(g,2),D=w[0],_=w[1],b.Horario1=this.findHorarioId(D),b.Horario2=this.findHorarioId(_),b.turno1=this.findTurno(b.Horario1,b.Horario2),"EAD"!==b.turno1&&(b.Sala1=this.findSalaId(D),b.Sala2=this.findSalaId(_))),v[n.docentes]&&(y=v[n.docentes].split(";"),C=f(y,2),k=C[0],H=C[1],b.Docente1=this.findDocenteId(k),b.Docente2=this.findDocenteId(H)),b.Disciplina&&b.letra&&b.turno1){r.next=24;break}return r.abrupt("continue",30);case 24:if(!this.isTheSameTurma(o,b)){r.next=26;break}return r.abrupt("continue",30);case 26:return r.next=28,this.createTurma(b);case 28:P=r.sent,o=Object(m["a"])({},P);case 30:u=!0,r.next=13;break;case 33:r.next=39;break;case 35:r.prev=35,r.t0=r["catch"](11),c=!0,d=r.t0;case 39:r.prev=39,r.prev=40,u||null==p.return||p.return();case 42:if(r.prev=42,!c){r.next=45;break}throw d;case 45:return r.finish(42);case 46:return r.finish(39);case 47:case"end":return r.stop()}},r,this,[[11,35,39,47],[40,,42,46]])}));function e(e){return r.apply(this,arguments)}return e}(),createPedido:function(){var r=Object(v["a"])(regeneratorRuntime.mark(function r(e,t,n){var a;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:if(a={Turma:null,Curso:null,vagasNaoPeriodizadas:0,vagasPeriodizadas:0,vagasOferecidas:0,vagasOcupadas:0},a.Turma=n,a.Curso=this.findCursoId(e[t.cursoCod]),a.vagasOferecidas=e[t.vagas1],a.vagasOcupadas=e[t.vagas2],!a.Curso){r.next=10;break}return r.next=8,this.editPedido(a);case 8:r.next=11;break;case 10:console.log("Curso não econtrado: "+e[t.cursoCod]);case 11:case"end":return r.stop()}},r,this)}));function e(e,t,n){return r.apply(this,arguments)}return e}(),findTurno:function(r,e){return r||e?31==r?"EAD":this.$_.some(this.HorariosNoturno,["id",r])||this.$_.some(this.HorariosNoturno,["id",e])?"Noturno":"Diurno":null},findCursoId:function(r){var e=this.$_.find(this.AllCursos,["codigo",r]);return e?e.id:null},findDocenteId:function(r){if(!r.length)return null;var e=this.$_.find(this.AllDocentes,function(e){return Object(x["c"])(e.nomesiga)===Object(x["c"])(r)});return e?e.id:null},findDisciplinaId:function(r){var e=this.$_.find(this.AllDisciplinas,["codigo",r]);return e?e.id:null},findHorarioId:function(r){if(!r)return null;var e=r.split(","),t=f(e,3),n=t[0],a=t[1],i=t[2],o=this.parseDiaEHora(n,a);if(o){var s=this.$_.find(this.AllHorarios,["horario",o]);return s?s.id:null}return Object(x["c"])(i).includes(Object(x["c"])("HORÁRIO EAD"))?(console.log("EAD sala",i),31):null},parseDiaEHora:function(r,e){if(!r||!e)return null;var t=null,n=null;switch(r.trim().substring(0,3).toLowerCase()){case"seg":t="2a";break;case"ter":t="3a";break;case"qua":t="4a";break;case"qui":t="5a";break;case"sex":t="6a";break;case"sab":return"EAD"}var a=this.$_.find(this.ListaDeTodosHorarios,function(r){return r.nome.includes(e.substring(0,2)+"-")})||{};return n=a.nome,t&&n?t+" "+n:null},findSalaId:function(r){if(!r)return null;var e=r.split(","),t=f(e,3),n=t[2],a=Object(x["c"])(n),i=this.$_.find(this.AllSalas,function(r){var e=Object(x["c"])(r.nome);return a.includes(e)});return i?i.id:null},isTheSameTurma:function(r,e){return r.letra===e.letra&&r.Disciplina===e.Disciplina&&r.turno1===e.turno1&&r.Horario1===e.Horario1&&r.Horario2===e.Horario2}}),computed:Object(m["a"])({},Object(b["c"])(["AllHorarios","HorariosNoturno","AllDisciplinas","AllCursos","ListaDeTodosHorarios","AllTurmas","AllSalas","AllDocentes","PeriodosLetivos"]))},_=D,y=t("2877"),C=Object(y["a"])(_,n,a,!1,null,null,null);e["default"]=C.exports},a21f:function(r,e,t){var n=t("584a"),a=n.JSON||(n.JSON={stringify:JSON.stringify});r.exports=function(r){return a.stringify.apply(a,arguments)}},f499:function(r,e,t){r.exports=t("a21f")}}]);
//# sourceMappingURL=chunk-5985da21.4fcb8156.js.map