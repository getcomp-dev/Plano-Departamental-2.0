(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01513015"],{a1c7:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("PageHeader",{attrs:{title:"Preferências dos docentes"}},[i("BaseButton",{attrs:{template:"adicionar"},on:{click:function(t){return e.openModalAddPreferencia()}}}),i("BaseButton",{attrs:{template:"swap-modes"},on:{click:function(t){return e.swapModes()}}}),i("BaseButton",{attrs:{template:"file-upload"},on:{click:function(t){return e.openModalUpload()}}})],1),i("div",{staticClass:"div-table"},[e.docentespordisciplina?i("BaseTable",{staticStyle:{border:"0px"},scopedSlots:e._u([{key:"thead",fn:function(){return[i("th",{staticStyle:{width:"80px"}},[e._v("Código")]),i("th",{staticStyle:{width:"420px"}},[e._v("Nome")]),i("th",{staticStyle:{width:"100px"}},[e._v("Perfil")]),i("th",{staticStyle:{width:"200px"}},[e._v("Docente")]),i("th",{staticStyle:{width:"40px"}},[e._v("Pref")])]},proxy:!0},{key:"tbody",fn:function(){return[e._l(e.DocentesPorDisciplinas,function(t){return[i("tr",{key:t[0].Disciplina+"headerDisciplina",staticClass:"bg-custom"},[i("td",{staticStyle:{width:"80px"}},[e._v("\n              "+e._s(e.disciplinaById(t[0].Disciplina).codigo)+"\n            ")]),i("td",{staticStyle:{width:"420px"}},[e._v("\n              "+e._s(e.disciplinaById(t[0].Disciplina).nome)+"\n            ")]),i("td",{staticStyle:{width:"100px"}},[e._v("\n              "+e._s(e.perfilById(e.disciplinaById(t[0].Disciplina).Perfil).abreviacao)+"\n            ")]),i("td",{staticStyle:{width:"200px"}}),i("td",{staticClass:"td-pref",staticStyle:{width:"40px"},on:{click:function(i){return e.openModalAddDocente(t[0].Disciplina)}}},[e._v("\n              +\n            ")])]),e._l(t,function(t){return i("tr",{key:"disciplina"+t.Disciplina+"docente"+t.Docente},[i("td",{staticStyle:{width:"80px"}}),i("td",{staticStyle:{width:"420px"}}),i("td",{staticStyle:{width:"100px"}}),i("td",{staticStyle:{width:"200px"}},[e._v("\n              "+e._s(e.docenteById(t.Docente).apelido)+"\n            ")]),i("td",{staticClass:"td-pref",staticStyle:{width:"40px"},on:{click:function(i){return e.openModalEdit(t)}}},[e._v("\n              "+e._s(t.preferencia)+"\n            ")])])})]})]},proxy:!0}],null,!1,150445489)}):i("BaseTable",{staticStyle:{border:"0px"},scopedSlots:e._u([{key:"thead",fn:function(){return[i("th",{staticStyle:{width:"200px"}},[e._v("Docente")]),i("th",{staticStyle:{width:"80px"}},[e._v("Código")]),i("th",{staticStyle:{width:"420px"}},[e._v("Nome")]),i("th",{staticStyle:{width:"100px"}},[e._v("Perfil")]),i("th",{staticStyle:{width:"40px"}},[e._v("Pref")])]},proxy:!0},{key:"tbody",fn:function(){return[e._l(e.DisciplinasPorDocentes,function(t){return[i("tr",{key:t[0].Docente+"headerDocente",staticClass:"bg-custom"},[i("td",{staticStyle:{width:"200px"}},[e._v("\n              "+e._s(e.docenteById(t[0].Docente).apelido)+"\n            ")]),i("td",{staticStyle:{width:"80px"}}),i("td",{staticStyle:{width:"420px"}}),i("td",{staticStyle:{width:"100px"}}),i("td",{staticClass:"td-pref",staticStyle:{width:"40px"},on:{click:function(i){return e.openModalAddDisciplina(t[0].Docente)}}},[e._v("\n              +\n            ")])]),e._l(t,function(t){return i("tr",{key:"docente"+t.Docente+"disciplina"+t.Disciplina},[i("td",{staticStyle:{width:"200px"}}),i("td",{staticStyle:{width:"80px"}},[e._v("\n              "+e._s(e.disciplinaById(t.Disciplina).codigo)+"\n            ")]),i("td",{staticStyle:{width:"420px"}},[e._v("\n              "+e._s(e.disciplinaById(t.Disciplina).nome)+"\n            ")]),i("td",{staticStyle:{width:"100px"}},[e._v("\n              "+e._s(e.perfilById(e.disciplinaById(t.Disciplina).Perfil).abreviacao)+"\n            ")]),i("td",{staticClass:"td-pref",staticStyle:{width:"40px"},on:{click:function(i){return e.openModalEdit(t)}}},[e._v("\n              "+e._s(t.preferencia)+"\n            ")])])})]})]},proxy:!0}])})],1),i("BaseModal",{ref:"modalEdit",attrs:{title:"Editar Preferência",hasFooter:!0},scopedSlots:e._u([{key:"modal-body",fn:function(){return[i("div",{staticClass:"row",style:{margin:"0"}},[i("p",[e._v("Docente: "+e._s(e.edit.docente?e.edit.docente.nome:""))])]),i("div",{staticClass:"row",style:{margin:"0"}},[i("p",[e._v("Disciplina: "+e._s(e.edit.disciplina?e.edit.disciplina.nome:""))])]),i("div",{staticClass:"row",style:{display:"table-cell",verticalAlign:"middle"}},[i("label",{attrs:{for:"inputPreferenciaDocentes"}},[e._v("Preferência: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.preferenciaForm.preferencia,expression:"preferenciaForm.preferencia"}],style:{width:"25px",height:"20px",marginLeft:"10px",textAlign:"center"},attrs:{type:"text",id:"inputPreferenciaDocentes"},domProps:{value:e.preferenciaForm.preferencia},on:{input:function(t){t.target.composing||e.$set(e.preferenciaForm,"preferencia",t.target.value)}}})])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("BaseButton",{staticClass:"ml-auto",attrs:{type:"text",color:"lightblue"},on:{click:function(t){return e.handleEditPrefs()}}},[e._v("Confirmar")])]},proxy:!0}])}),i("BaseModal",{ref:"modalAddDocente",attrs:{title:"Adicionar Preferência",hasFooter:!0},scopedSlots:e._u([{key:"modal-body",fn:function(){return[i("div",{staticClass:"row",style:{margin:"0"}},[i("p",[e._v("Disciplina: "+e._s(e.add.Disciplina?e.add.Disciplina.nome:""))])]),i("div",{staticClass:"row",style:{margin:"0"}},[i("label",{attrs:{for:"selectPreferenciaAdicionarDocentes"}},[e._v("Docente: ")]),i("select",{directives:[{name:"model",rawName:"v-model",value:e.add.Docente,expression:"add.Docente"}],staticStyle:{width:"200px"},attrs:{id:"selectPreferenciaAdicionarDocentes"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.add,"Docente",t.target.multiple?i:i[0])}}},e._l(e.AllDocentes,function(t){return i("option",{key:"adicionarDocente"+t.id,domProps:{value:t.id}},[e._v("\n            "+e._s(t.apelido)+"\n          ")])}),0)]),i("div",{staticClass:"row",style:{display:"table-cell",verticalAlign:"middle"}},[i("label",{attrs:{for:"inputPreferenciaAdicionarDocentes"}},[e._v("Preferência: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.add.preferencia,expression:"add.preferencia"}],style:{width:"25px",height:"20px",marginLeft:"10px",textAlign:"center"},attrs:{type:"text",id:"inputPreferenciaAdicionarDocentes"},domProps:{value:e.add.preferencia},on:{input:function(t){t.target.composing||e.$set(e.add,"preferencia",t.target.value)}}})])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("BaseButton",{staticClass:"ml-auto",attrs:{type:"text",color:"lightblue"},on:{click:function(t){return e.addPreferencia()}}},[e._v("Confirmar")])]},proxy:!0}])}),i("BaseModal",{ref:"modalAddDisciplina",attrs:{title:"Adicionar Preferência",hasFooter:!0},scopedSlots:e._u([{key:"modal-body",fn:function(){return[i("div",{staticClass:"row",style:{margin:"0"}},[i("p",[e._v("Docente: "+e._s(e.add.Docente?e.add.Docente.apelido:""))])]),i("div",{staticClass:"row",style:{margin:"0"}},[i("label",{attrs:{for:"selectPreferenciaAdicionarDisciplinas"}},[e._v("Disciplina: ")]),i("select",{directives:[{name:"model",rawName:"v-model",value:e.add.Disciplina,expression:"add.Disciplina"}],staticStyle:{width:"200px"},attrs:{id:"selectPreferenciaAdicionarDisciplinas"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.add,"Disciplina",t.target.multiple?i:i[0])}}},e._l(e.AllDisciplinas,function(t){return i("option",{key:"adicionarDisciplina"+t.id,domProps:{value:t.id}},[e._v("\n            "+e._s(t.codigo)+" - "+e._s(t.nome)+"\n          ")])}),0)]),i("div",{staticClass:"row",style:{display:"table-cell",verticalAlign:"middle"}},[i("label",{attrs:{for:"inputPreferenciaAdicionarDisciplinas"}},[e._v("Preferência: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.add.preferencia,expression:"add.preferencia"}],style:{width:"25px",height:"20px",marginLeft:"10px",textAlign:"center"},attrs:{type:"text",id:"inputPreferenciaAdicionarDisciplinas"},domProps:{value:e.add.preferencia},on:{input:function(t){t.target.composing||e.$set(e.add,"preferencia",t.target.value)}}})])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("BaseButton",{staticClass:"ml-auto",attrs:{type:"text",color:"lightblue"},on:{click:function(t){return e.addPreferencia()}}},[e._v("Confirmar")])]},proxy:!0}])}),i("BaseModal",{ref:"modalAddPreferencia",attrs:{title:"Adicionar Preferência",hasFooter:!0},scopedSlots:e._u([{key:"modal-body",fn:function(){return[i("div",{staticClass:"row",style:{margin:"0"}},[i("label",{attrs:{for:"selectPreferenciaAdicionarPreferenciaDocentes"}},[e._v("Docente:\n        ")]),i("select",{directives:[{name:"model",rawName:"v-model",value:e.add.Docente,expression:"add.Docente"}],staticStyle:{width:"200px","margin-left":"auto"},attrs:{id:"selectPreferenciaAdicionarPreferenciaDocentes"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.add,"Docente",t.target.multiple?i:i[0])}}},e._l(e.AllDocentes,function(t){return i("option",{key:"adicionarPreferenciaDocente"+t.id,domProps:{value:t.id}},[e._v("\n            "+e._s(t.apelido)+"\n          ")])}),0)]),i("div",{staticClass:"row",style:{margin:"0"}},[i("label",{attrs:{for:"selectPreferenciaAdicionarPreferenciaDisciplinas"}},[e._v("Disciplina:\n        ")]),i("select",{directives:[{name:"model",rawName:"v-model",value:e.add.Disciplina,expression:"add.Disciplina"}],staticStyle:{width:"200px","margin-left":"auto"},attrs:{id:"selectPreferenciaAdicionarPreferenciaDisciplinas"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.add,"Disciplina",t.target.multiple?i:i[0])}}},e._l(e.AllDisciplinas,function(t){return i("option",{key:"adicionarPreferenciaDisciplina"+t.id,domProps:{value:t.id}},[e._v("\n            "+e._s(t.codigo)+" - "+e._s(t.nome)+"\n          ")])}),0)]),i("div",{staticClass:"row",style:{display:"table-cell",verticalAlign:"middle"}},[i("label",{attrs:{for:"inputPreferenciaAdicionarPreferencia"}},[e._v("Preferência: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.add.preferencia,expression:"add.preferencia"}],style:{width:"25px",height:"20px",marginLeft:"10px",textAlign:"center"},attrs:{type:"text",id:"inputPreferenciaAdicionarPreferencia"},domProps:{value:e.add.preferencia},on:{input:function(t){t.target.composing||e.$set(e.add,"preferencia",t.target.value)}}})])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("BaseButton",{staticClass:"ml-auto",attrs:{type:"text",color:"lightblue"},on:{click:function(t){return e.addPreferencia()}}},[e._v("Confirmar")])]},proxy:!0}])}),i("BaseModal",{ref:"modalUpload",attrs:{title:"Selecione um arquivo para importar",hasFooter:!0},scopedSlots:e._u([{key:"modal-body",fn:function(){return[i("input",{ref:"xlsxPrefs",attrs:{type:"file",id:"xlsxPrefs"}})]},proxy:!0},{key:"modal-footer",fn:function(){return[i("BaseButton",{staticClass:"ml-auto",attrs:{type:"text",color:"lightblue"},on:{click:e.importPrefs}},[e._v("Importar")])]},proxy:!0}])})],1)},n=[],r=(i("ac6a"),i("f3e2"),i("a481"),i("7514"),i("57e7"),i("28a5"),i("d25f"),i("7f7f"),i("cebc")),o=i("2f62"),s=i("8489"),c=i("9165"),d=i("25df"),l=i("d027"),p=i("1146"),f=i.n(p),u=i("2ef0"),y=i.n(u),h=(i("2107"),{name:"DashboardPreferencias",mixins:[c["l"],c["k"]],components:{Card:d["b"],ModalAjuda:l["a"],ModalDelete:l["b"]},data:function(){return{file:void 0,preferenciaForm:{Docente:void 0,Disciplina:void 0,preferencia:void 0},edit:{docente:void 0,disciplina:void 0,isZero:void 0},add:{Docente:void 0,Disciplina:void 0,preferencia:void 0},error:void 0,docentespordisciplina:!0}},methods:Object(r["a"])({},Object(o["b"])(["setPartialLoading"]),{importPrefs:function(){console.log(this.PreferenciaDosDocentes),this.file=this.$refs.xlsxPrefs.files[0];var e=new FileReader,t=(this.file.name,this.AllDocentes),i=this.AllDisciplinas,a=this.PreferenciaDosDocentes;e.onload=function(e){for(var n=e.target.result,r=f.a.read(n,{type:"binary"}),o=r.Sheets[r.SheetNames[0]],c=f.a.utils.sheet_to_json(o),d=y.a.filter(y.a.split(f.a.utils.sheet_to_csv(o),","),function(e){return"Disciplinas"===e.substring(0,11)}),l=[],p=0;p<d.length;p++){var u=d[p].indexOf("["),h=d[p].indexOf("\t"),v=y.a.find(i,{codigo:d[p].substring(u+1,h)});l.push(v),v||console.log(d[p]+" não existe no sistema")}for(var m=0;m<c.length;m++){var D=y.a.find(t,{nome:c[m].Nome.toUpperCase()});if(D)for(var g=0;g<d.length;g++)if(l[g]){var x=y.a.find(a,{Docente:D.id,Disciplina:l[g].id});if(c[m][d[g]]&&0!=c[m][d[g]]){var _={Docente:D.id,Disciplina:l[g].id,preferencia:c[m][d[g]]};x?x.preferencia!=_.preferencia&&s["a"].update(x.Disciplina,x.Docente,_):s["a"].create(_)}else x&&s["a"].delete(x.Disciplina,x.Docente)}}},e.readAsBinaryString(this.file),this.$refs.modalUpload.close()},preferencia:function(e,t){var i=this.$_.find(this.PreferenciaDosDocentes,{Docente:e.id,Disciplina:t.id});return i?i.preferencia:0},openModalEdit:function(e){this.edit.docente=this.docenteById(e.Docente),this.edit.disciplina=this.disciplinaById(e.Disciplina);var t=e.preferencia;this.edit.isZero=0===t,this.preferenciaForm={Docente:e.Docente,Disciplina:e.Disciplina,preferencia:t},this.$refs.modalEdit.open()},openModalAddDocente:function(e){this.add.Disciplina=this.disciplinaById(e),this.$refs.modalAddDocente.open()},openModalAddDisciplina:function(e){this.add.Docente=this.docenteById(e),this.$refs.modalAddDisciplina.open()},openModalAddPreferencia:function(){this.$refs.modalAddPreferencia.open()},handleEditPrefs:function(){var e=this;this.edit.isZero?0!=this.preferenciaForm.preferencia&&(s["a"].create(this.preferenciaForm).then(function(){e.$notify({group:"general",title:"Sucesso!",text:"Preferência atualizada com sucesso!",type:"success"}),e.$refs.modalEdit.close()}).catch(function(t){e.error="<b>Erro ao atualizar Preferência</b>",t.response.data.fullMessage&&(e.error+="<br/>"+t.response.data.fullMessage.replace("\n","<br/>")),e.$notify({group:"general",title:"Erro!",text:e.error,type:"error"})}),this.edit.isZero=!1):this.preferenciaForm.preferencia!=this.preferencia(this.edit.docente,this.edit.disciplina)&&(0==this.preferenciaForm.preferencia?(s["a"].delete(this.preferenciaForm.Disciplina,this.preferenciaForm.Docente).then(function(){e.$notify({group:"general",title:"Sucesso!",text:"Preferência atualizada com sucesso!",type:"success"}),e.$refs.modalEdit.close()}).catch(function(t){e.error="<b>Erro ao atualizar Preferência</b>",t.response.data.fullMessage&&(e.error+="<br/>"+t.response.data.fullMessage.replace("\n","<br/>")),e.$notify({group:"general",title:"Erro!",text:e.error,type:"error"})}),this.edit.isZero=!0):s["a"].update(this.preferenciaForm.Disciplina,this.preferenciaForm.Docente,this.preferenciaForm).then(function(){e.$notify({group:"general",title:"Sucesso!",text:"Preferência atualizada com sucesso!",type:"success"}),e.$refs.modalEdit.close()}).catch(function(t){e.error="<b>Erro ao atualizar Preferência</b>",t.response.data.fullMessage&&(e.error+="<br/>"+t.response.data.fullMessage.replace("\n","<br/>")),e.$notify({group:"general",title:"Erro!",text:e.error,type:"error"})}))},addPreferencia:function(){var e=this;console.log(this.add),this.add.Docente&&this.add.Disciplina&&this.add.preferencia&&(this.add.Docente.id&&(this.add.Docente=this.add.Docente.id),this.add.Disciplina.id&&(this.add.Disciplina=this.add.Disciplina.id),console.log(this.add),s["a"].create(this.add).then(function(){e.$notify({group:"general",title:"Sucesso!",text:"Preferência adicionada com sucesso!",type:"success"}),e.add.Disciplina=void 0,e.add.Docente=void 0,e.add.preferencia=void 0,e.$refs.modalAddDocente.close(),e.$refs.modalAddDisciplina.close()}).catch(function(t){e.error="<b>Erro ao atualizar Preferência</b>",t.response.data.fullMessage&&(e.error+="<br/>"+t.response.data.fullMessage.replace("\n","<br/>")),e.$notify({group:"general",title:"Erro!",text:e.error,type:"error"}),e.add.Disciplina=void 0,e.add.Docente=void 0,e.add.preferencia=void 0,e.$refs.modalAddDocente.close(),e.$refs.modalAddDisciplina.close()}))},openModalUpload:function(){this.$refs.modalUpload.open()},disciplinaById:function(e){return y.a.find(this.AllDisciplinas,{id:e})},docenteById:function(e){return y.a.find(this.AllDocentes,{id:e})},perfilById:function(e){return y.a.find(this.AllPerfis,{id:e})},swapModes:function(){this.docentespordisciplina=!this.docentespordisciplina}}),computed:Object(r["a"])({},Object(o["c"])(["AllDocentes","AllDisciplinas","PreferenciaDosDocentes","AllPerfis"]),{DocentesPorDisciplinas:function(){var e=this,t={},i=y.a.orderBy(this.PreferenciaDosDocentes,function(t){return e.disciplinaById(t.Disciplina).codigo});for(var a in i.forEach(function(i){var a=e.disciplinaById(i.Disciplina).codigo;void 0===t[a]&&(t[a]=[]),t[a].push(i)}),t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]=y.a.orderBy(y.a.orderBy(t[a],function(t){return e.docenteById(t.Docente).apelido}),["preferencia"],["desc"]));return t},DisciplinasPorDocentes:function(){var e=this,t={},i=y.a.orderBy(this.PreferenciaDosDocentes,function(t){return e.docenteById(t.Docente).apelido});for(var a in i.forEach(function(i){var a=e.docenteById(i.Docente).apelido;void 0===t[a]&&(t[a]=[]),t[a].push(i)}),t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]=y.a.orderBy(y.a.orderBy(t[a],function(t){return e.disciplinaById(t.Disciplina).codigo}),["preferencia"],["desc"]));return t}})}),v=h,m=(i("c06f"),i("2877")),D=Object(m["a"])(v,a,n,!1,null,"003c90e3",null);t["default"]=D.exports},c06f:function(e,t,i){"use strict";var a=i("c561"),n=i.n(a);n.a},c561:function(e,t,i){}}]);
//# sourceMappingURL=chunk-01513015.16305aa4.js.map