(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-240ed4a2"],{1251:function(i,e,a){"use strict";var s=a("7d87"),o=a.n(s);o.a},"6e60":function(i,e,a){"use strict";a.r(e);var s=function(){var i=this,e=i.$createElement,a=i._self._c||e;return a("BaseModal",{ref:"baseModalNovoPlano",attrs:{title:"Turmas do novo plano",type:"editTurma",hasBackground:!0,hasFooter:!0,btnOkText:"Criar plano"},on:{"on-close":function(e){i.searchDisciplinasModal=""}},scopedSlots:i._u([{key:"modal-body",fn:function(){return[a("p",{staticClass:"alert alert-secondary"},[i._v("\n      Selecione as disciplinas para quais as turmas do plano atual\n      "),a("b",[i._v(i._s(i.currentPlano.nome+" - "+i.currentPlano.ano))]),i._v("\n      serão copiadas para o novo plano\n    ")]),a("div",{staticClass:"div-table"},[a("BaseTable",{attrs:{type:"modal",styles:"max-height: 500px;height:500px",hasSearchBar:!0},scopedSlots:i._u([{key:"thead-search",fn:function(){return[a("InputSearch",{attrs:{placeholder:"Pesquise nome ou codigo de uma disciplina..."},model:{value:i.searchDisciplinasModal,callback:function(e){i.searchDisciplinasModal=e},expression:"searchDisciplinasModal"}})]},proxy:!0},{key:"thead",fn:function(){return[a("th",{staticStyle:{width:"25px"}}),a("th",{staticClass:"t-start clickable",staticStyle:{width:"70px"},attrs:{title:"Código"},on:{click:function(e){return i.toggleOrder(i.ordenacaoModal.disciplinas,"codigo")}}},[i._v("\n            Cód.\n            "),a("i",{class:i.setIconByOrder(i.ordenacaoModal.disciplinas,"codigo")})]),a("th",{staticClass:"t-start clickable",staticStyle:{width:"270px"},on:{click:function(e){return i.toggleOrder(i.ordenacaoModal.disciplinas,"nome")}}},[i._v("\n            Nome\n            "),a("i",{class:i.setIconByOrder(i.ordenacaoModal.disciplinas,"nome")})]),a("th",{staticClass:"t-start clickable",staticStyle:{width:"85px"},on:{click:function(e){return i.toggleOrder(i.ordenacaoModal.disciplinas,"perfilAbreviacao")}}},[i._v("\n            Perfil\n            "),a("i",{class:i.setIconByOrder(i.ordenacaoModal.disciplinas,"perfilAbreviacao")})])]},proxy:!0},{key:"tbody",fn:function(){return[i._l(i.DisciplinasOrderedModal,function(e){return a("tr",{key:"MdDisciplina"+e.id,on:{click:function(a){return i.toggleItemInArray(e.id,i.filtrosDisciplinas)}}},[a("td",{staticStyle:{width:"25px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:i.filtrosDisciplinas,expression:"filtrosDisciplinas"}],staticClass:"form-check-input position-static m-0",attrs:{type:"checkbox"},domProps:{value:e.id,checked:Array.isArray(i.filtrosDisciplinas)?i._i(i.filtrosDisciplinas,e.id)>-1:i.filtrosDisciplinas},on:{change:function(a){var s=i.filtrosDisciplinas,o=a.target,r=!!o.checked;if(Array.isArray(s)){var t=e.id,n=i._i(s,t);o.checked?n<0&&(i.filtrosDisciplinas=s.concat([t])):n>-1&&(i.filtrosDisciplinas=s.slice(0,n).concat(s.slice(n+1)))}else i.filtrosDisciplinas=r}}})]),a("td",{staticClass:"t-start",staticStyle:{width:"70px"}},[i._v("\n              "+i._s(e.codigo)+"\n            ")]),a("td",{staticClass:"t-start",staticStyle:{width:"270px"}},[i._v("\n              "+i._s(e.nome)+"\n            ")]),a("td",{staticClass:"t-start",staticStyle:{width:"85px"}},[i._v("\n              "+i._s(e.perfil.abreviacao)+"\n            ")])])}),0===i.DisciplinasOrderedModal.length?a("tr",[a("td",{staticStyle:{width:"450px"},attrs:{colspan:"3"}},[i._v("\n              NENHUMA DISCIPLINA ENCONTRADA.\n            ")])]):i._e()]},proxy:!0}])})],1)]},proxy:!0},{key:"modal-footer",fn:function(){return[a("div",[a("BaseButton",{attrs:{text:"Selecionar Todos",color:"lightblue"},on:{click:i.selectAllDisciplinas}}),a("BaseButton",{attrs:{text:"Desmarcar Todos",color:"gray"},on:{click:i.selectNoneDisciplinas}}),i._t("modal-footer-btn")],2),a("BaseButton",{staticClass:"px-3",attrs:{text:"OK",color:"green"},on:{click:i.createNovoPlano}})]},proxy:!0}],null,!0)})},o=[],r=(a("4917"),a("cebc")),t=(a("6762"),a("2fdb"),a("ac6a"),a("f3e2"),a("7514"),a("e814")),n=a.n(t),c=(a("d25f"),a("6d67"),a("75fc")),d=a("2f62"),l=a("5bdd"),p=a("16ba"),u=a("ebd8"),f=a("456a"),C=a("7ed3"),h=a("eaf8"),D=a("9165"),m=a("25df"),v={name:"ModalNovoPlano",mixins:[D["k"],D["l"]],components:{InputSearch:m["d"]},props:{plano:{type:Object,required:!0}},data:function(){return{searchDisciplinasModal:"",filtrosDisciplinas:[],ordenacaoModal:{disciplinas:{order:"codigo",type:"asc"}},grades1semestre:{CCD:[],CCN:[],EC:[],SI:[]},grades2semestre:{CCD:[],CCN:[],EC:[],SI:[]}}},methods:{open:function(){this.$refs.baseModalNovoPlano.open()},close:function(){this.$refs.baseModalNovoPlano.close()},selectAllDisciplinas:function(){this.filtrosDisciplinas=Object(c["a"])(this.$_.map(this.DisciplinasInPerfis,function(i){return i.id}))},selectNoneDisciplinas:function(){this.filtrosDisciplinas=[]},gradesAtivas:function(i){var e,a,s;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",4]),e=this.$_.orderBy(e,"periodoInicio","desc"),s=0;for(var o=0;o<e.length;o++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[o].periodoInicio.slice(0,4),10))+(1-n()(e[o].periodoInicio.slice(5,6),10))/2,this.grades1semestre.CCD.push({id:e[o].id,inicio:a,fim:s}),s>9)break;s=0;for(var r=0;r<e.length;r++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[r].periodoInicio.slice(0,4),10))+(3-n()(e[r].periodoInicio.slice(5,6),10))/2,this.grades2semestre.CCD.push({id:e[r].id,inicio:a,fim:s}),s>9)break;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",1]),e=this.$_.orderBy(e,"periodoInicio","desc"),s=0;for(var t=0;t<e.length;t++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[t].periodoInicio.slice(0,4),10))+(1-n()(e[t].periodoInicio.slice(5,6),10))/2,this.grades1semestre.CCN.push({id:e[t].id,inicio:a,fim:s}),s>9)break;s=0;for(var c=0;c<e.length;c++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[c].periodoInicio.slice(0,4),10))+(3-n()(e[c].periodoInicio.slice(5,6),10))/2,this.grades2semestre.CCN.push({id:e[c].id,inicio:a,fim:s}),s>9)break;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",3]),e=this.$_.orderBy(e,"periodoInicio","desc"),s=0;for(var d=0;d<e.length;d++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[d].periodoInicio.slice(0,4),10))+(1-n()(e[d].periodoInicio.slice(5,6),10))/2,this.grades1semestre.SI.push({id:e[d].id,inicio:a,fim:s}),s>9)break;s=0;for(var l=0;l<e.length;l++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[l].periodoInicio.slice(0,4),10))+(3-n()(e[l].periodoInicio.slice(5,6),10))/2,this.grades2semestre.SI.push({id:e[l].id,inicio:a,fim:s}),s>9)break;e=this.$_.filter(this.$store.state.grade.Grades,["Curso",2]),e=this.$_.orderBy(e,"periodoInicio","desc"),s=0;for(var p=0;p<e.length;p++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[p].periodoInicio.slice(0,4),10))+(1-n()(e[p].periodoInicio.slice(5,6),10))/2,this.grades1semestre.EC.push({id:e[p].id,inicio:a,fim:s}),s>9)break;s=0;for(var u=0;u<e.length;u++)if(a=s+1,s=1+2*(n()(i,10)-n()(e[u].periodoInicio.slice(0,4),10))+(3-n()(e[u].periodoInicio.slice(5,6),10))/2,this.grades2semestre.EC.push({id:e[u].id,inicio:a,fim:s}),s>9)break},generateTurmasNovoPlano:function(){var i=this;this.gradesAtivas(this.plano.ano);for(var e=[],a=[],s=function(a){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.CCD[a].id});s.forEach(function(s){if(s.periodo%2===1&&s.periodo>=i.grades1semestre.CCD[a].inicio&&s.periodo<=i.grades1semestre.CCD[a].fim){var o=i.$_.find(e,{Disciplina:s.Disciplina});void 0===o?e.push({Disciplina:s.Disciplina,CCD:!0,EC:!1,CCN:!1,SI:!1,periodo:1}):o.CCD=!0}})},o=0;o<this.grades1semestre.CCD.length;o++)s(o);var r=function(a){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.EC[a].id});s.forEach(function(s){if(s.periodo%2===1&&s.periodo>=i.grades1semestre.EC[a].inicio&&s.periodo<=i.grades1semestre.EC[a].fim){var o=i.$_.find(e,{Disciplina:s.Disciplina});void 0===o?e.push({Disciplina:s.Disciplina,CCD:!1,EC:!0,CCN:!1,SI:!1,periodo:1}):o.EC=!0}})};for(o=0;o<this.grades1semestre.EC.length;o++)r(o);var t=function(a){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.CCN[a].id});s.forEach(function(s){if(s.periodo%2===0&&s.periodo>=i.grades1semestre.CCN[a].inicio&&s.periodo<=i.grades1semestre.CCN[a].fim){var o=i.$_.find(e,{Disciplina:s.Disciplina});void 0===o?e.push({Disciplina:s.Disciplina,CCD:!1,EC:!1,CCN:!0,SI:!1,periodo:1}):o.CCN=!0}})};for(o=0;o<this.grades1semestre.CCN.length;o++)t(o);var n=function(a){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades1semestre.SI[a].id});s.forEach(function(s){if(s.periodo%2===0&&s.periodo>=i.grades1semestre.SI[a].inicio&&s.periodo<=i.grades1semestre.SI[a].fim){var o=i.$_.find(e,{Disciplina:s.Disciplina});void 0===o?e.push({Disciplina:s.Disciplina,CCD:!1,EC:!1,CCN:!1,SI:!0,periodo:1}):o.SI=!0}})};for(o=0;o<this.grades1semestre.SI.length;o++)n(o);var c=function(e){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.CCD[e].id});s.forEach(function(s){if(s.periodo%2===0&&s.periodo>=i.grades2semestre.CCD[e].inicio&&s.periodo<=i.grades2semestre.CCD[e].fim){var o=i.$_.find(a,{Disciplina:s.Disciplina});void 0===o?a.push({Disciplina:s.Disciplina,CCD:!0,EC:!1,CCN:!1,SI:!1,periodo:3}):o.CCD=!0}})};for(o=0;o<this.grades2semestre.CCD.length;o++)c(o);var d=function(e){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.EC[e].id});s.forEach(function(s){if(s.periodo%2===0&&s.periodo>=i.grades2semestre.EC[e].inicio&&s.periodo<=i.grades2semestre.EC[e].fim){var o=i.$_.find(a,{Disciplina:s.Disciplina});void 0===o?a.push({Disciplina:s.Disciplina,CCD:!1,EC:!0,CCN:!1,SI:!1,periodo:3}):o.EC=!0}})};for(o=0;o<this.grades2semestre.EC.length;o++)d(o);var l=function(e){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.CCN[e].id});s.forEach(function(s){if(s.periodo%2===1&&s.periodo>=i.grades2semestre.CCN[e].inicio&&s.periodo<=i.grades2semestre.CCN[e].fim){var o=i.$_.find(a,{Disciplina:s.Disciplina});void 0===o?a.push({Disciplina:s.Disciplina,CCD:!1,EC:!1,CCN:!0,SI:!1,periodo:3}):o.CCN=!0}})};for(o=0;o<this.grades2semestre.CCN.length;o++)l(o);var p=function(e){var s=i.$_.filter(i.$store.state.disciplinaGrade.DisciplinaGrades,{Grade:i.grades2semestre.SI[e].id});s.forEach(function(s){if(s.periodo%2===1&&s.periodo>=i.grades2semestre.SI[e].inicio&&s.periodo<=i.grades2semestre.SI[e].fim){var o=i.$_.find(a,{Disciplina:s.Disciplina});void 0===o?a.push({Disciplina:s.Disciplina,CCD:!1,EC:!1,CCN:!1,SI:!0,periodo:3}):o.SI=!0}})};for(o=0;o<this.grades2semestre.SI.length;o++)p(o);e=this.$_.filter(e,function(e){var a=i.$_.find(i.AllDisciplinas,{id:e.Disciplina}).Perfil;return 13!==a&&15!==a}),a=this.$_.filter(a,function(e){var a=i.$_.find(i.AllDisciplinas,{id:e.Disciplina}).Perfil;return 13!==a&&15!==a});var u=[];return e.forEach(function(e){i.$_.includes(i.filtrosDisciplinas,e.Disciplina)||((e.CCD||e.EC)&&(e.CCN||e.SI)?(u.push({semestre:1,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}),u.push({semestre:1,Disciplina:e.Disciplina,turno:"Noturno",letra:"B",CCN:e.CCN,SI:e.SI})):e.CCD||e.EC?u.push({semestre:1,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}):(e.CCN||e.SI)&&u.push({semestre:1,Disciplina:e.Disciplina,turno:"Noturno",letra:"A",CCN:e.CCN,SI:e.SI}))}),a.forEach(function(e){i.$_.includes(i.filtrosDisciplinas,e.Disciplina)||((e.CCD||e.EC)&&(e.CCN||e.SI)?(u.push({semestre:3,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}),u.push({semestre:3,Disciplina:e.Disciplina,turno:"Noturno",letra:"B",CCN:e.CCN,SI:e.SI})):e.CCD||e.EC?u.push({semestre:3,Disciplina:e.Disciplina,turno:"Diurno",letra:"A",CCD:e.CCD,EC:e.EC}):(e.CCN||e.SI)&&u.push({semestre:3,Disciplina:e.Disciplina,turno:"Noturno",letra:"A",CCN:e.CCN,SI:e.SI}))}),u},createNovoPlano:function(){var i=this;this.setPartialLoading(!0);var e=this.generateTurmasNovoPlano();u["a"].create(this.plano).then(function(a){e.forEach(function(i){f["a"].create({id:void 0,periodo:i.semestre,letra:i.letra,turno1:i.turno,turno2:void 0,Disciplina:i.Disciplina,Docente1:void 0,Docente2:void 0,Horario1:void 0,Horario2:void 0,Sala1:void 0,Sala2:void 0,Plano:a.Plano.id}).then(function(e){i.CCN&&C["a"].update(1,e.Turma.id,{Turma:e.Turma.id,Curso:1,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then(function(i){}).catch(function(i){console.log("erro ao atualizar pedido: "+i)}),i.EC&&C["a"].update(2,e.Turma.id,{Turma:e.Turma.id,Curso:2,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then(function(i){}).catch(function(i){console.log("erro ao atualizar pedido: "+i)}),i.SI&&C["a"].update(3,e.Turma.id,{Turma:e.Turma.id,Curso:3,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then(function(i){}).catch(function(i){console.log("erro ao atualizar pedido: "+i)}),i.CCD&&C["a"].update(4,e.Turma.id,{Turma:e.Turma.id,Curso:4,vagasPeriodizadas:1,vagasNaoPeriodizadas:0}).then(function(i){}).catch(function(i){console.log("erro ao atualizar pedido: "+i)})}).catch(function(i){console.log("erro ao criar turma: "+i)})});var s=i.$_.filter(i.$store.state.turma.Turmas,function(e){var a=i.$_.includes(i.filtrosDisciplinas,e.Disciplina);return!!a});s.forEach(function(e){f["a"].create({id:void 0,periodo:e.periodo,letra:e.letra,turno1:e.turno1,turno2:void 0,Disciplina:e.Disciplina,Horario1:e.Horario1,Horario2:e.Horario2,Sala1:void 0,Sala2:void 0,Plano:a.Plano.id}).then(function(a){var s=i.$store.state.pedido.Pedidos[e.id];s.forEach(function(i){C["a"].update(i.Curso,a.Turma.id,{Turma:a.Turma.id,Curso:i.Curso,vagasPeriodizadas:i.vagasPeriodizadas,vagasNaoPeriodizadas:0}).then(function(i){}).catch(function(i){console.log("erro ao atualizar pedido: "+i)})})}).catch(function(i){console.log("erro ao criar turma externa: "+i)})}),i.$store.state.turmaExterna.Turmas.forEach(function(e){p["a"].create({id:void 0,periodo:e.periodo,letra:e.letra,turno1:e.turno1,turno2:void 0,Disciplina:e.Disciplina,Horario1:e.Horario1,Horario2:e.Horario2,Sala1:void 0,Sala2:void 0,Plano:a.Plano.id}).then(function(a){var s=i.$store.state.pedidoExterno.Pedidos[e.id];s.forEach(function(i){l["a"].update(i.Curso,a.Turma.id,{Turma:a.Turma.id,Curso:i.Curso,vagasPeriodizadas:i.vagasPeriodizadas,vagasNaoPeriodizadas:i.vagasNaoPeriodizadas}).then(function(i){}).catch(function(i){console.log("erro ao atualizar pedido externo: "+i)})})}).catch(function(i){console.log("erro ao criar turma externa: "+i)})}),i.$store.dispatch("fetchAll").then(function(){setTimeout(function(){i.setPartialLoading(!1),i.close()},300)})})}},computed:Object(r["a"])({},Object(d["c"])(["AllPlanos","DisciplinasInPerfis","AllDisciplinas","currentPlano"]),{DisciplinasOrderedModal:function(){return this.$_.orderBy(this.DisciplinasFiltredModal,this.ordenacaoModal.disciplinas.order,this.ordenacaoModal.disciplinas.type)},DisciplinasFiltredModal:function(){if(""===this.searchDisciplinasModal)return this.DisciplinasInPerfis;var i=Object(h["c"])(this.searchDisciplinasModal);return this.$_.filter(this.DisciplinasInPerfis,function(e){var a=Object(h["c"])(e.nome),s=Object(h["c"])(e.codigo);return a.match(i)||s.match(i)})}})},g=v,I=(a("1251"),a("2877")),N=Object(I["a"])(g,s,o,!1,null,"25066a8a",null);e["default"]=N.exports},"7d87":function(i,e,a){}}]);
//# sourceMappingURL=chunk-240ed4a2.101d93b4.js.map