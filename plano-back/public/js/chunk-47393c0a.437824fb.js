(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47393c0a"],{"0441":function(e,t,r){},"0bad":function(e,t,r){"use strict";r("af8d")},"1eb9":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("BaseModal",{ref:"baseModalPlano",attrs:{title:"Plano Departamental",type:"editTurma",classes:"modal-plano",hasOverlay:!0,hasFooter:!0},scopedSlots:e._u([{key:"modal-body",fn:function(){return[r("NavTab",{attrs:{currentTab:e.currentTab,allTabs:["Importar","Copiar"]},on:{"change-tab":function(t){e.currentTab=t}}}),"Importar"===e.currentTab?r("ImportPlano",{ref:"importPlano",attrs:{plano:e.plano,closeModal:e.close}}):e._e(),"Copiar"===e.currentTab?r("CopyPlano",{ref:"copyPlano",attrs:{plano:e.plano,closeModal:e.close}}):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return["Copiar"===e.currentTab?[r("BaseButton",{attrs:{text:"Selecionar Todos",color:"lightblue"},on:{click:function(t){return e.$refs.copyPlano.selectAllDisciplinas()}}}),r("BaseButton",{attrs:{text:"Desmarcar Todos",color:"gray"},on:{click:function(t){return e.$refs.copyPlano.selectNoneDisciplinas()}}}),r("BaseButton",{staticClass:"px-3 ml-auto",attrs:{text:"OK",color:"green"},on:{click:e.handleCreatePlano}})]:[r("BaseButton",{staticClass:"px-3 ml-auto",attrs:{text:"OK",color:"green"},on:{click:e.handleCreatePlano}})]]},proxy:!0}])})},n=[],o=(r("96cf"),r("1da1")),i=r("25df"),c=r("4775"),s=r("9ae6"),l={name:"ModalNovoPlano",components:{CopyPlano:c["default"],ImportPlano:s["default"],NavTab:i["e"]},props:{plano:{type:Object,required:!0}},data:function(){return{currentTab:"Importar"}},methods:{open:function(){this.$refs.baseModalPlano.open()},close:function(){this.$refs.baseModalPlano.close()},handleCreatePlano:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("Importar"!==this.currentTab){e.next=5;break}return e.next=3,this.$refs.importPlano.handleImportPlano();case 3:e.next=8;break;case 5:if("Copiar"!==this.currentTab){e.next=8;break}return e.next=8,this.$refs.copyPlano.handleCopyPlano();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},u=l,f=(r("4c05"),r("2877")),d=Object(f["a"])(u,a,n,!1,null,null,null);t["default"]=d.exports},"348f":function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return g})),r.d(t,"a",(function(){return O}));r("4f37"),r("6762"),r("2fdb"),r("28a5");var a=r("3835"),n=r("4360"),o=r("0a94"),i=r("9429"),c=r("eaf8");function s(e,t,r,a){var n=Object(c["c"])({periodo:a||null,Plano:r||null,letra:e[t.letra]||null});return n.letra?(l(n,e[t.disciplinaCod]),n.Disciplina?(u(n,e[t.horarioESala]),n.turno1?(f(n,e[t.docentes]),n):null):null):null}function l(e,t){if(t){var r=Object(o["a"])(n["a"].getters.AllDisciplinas,["codigo",t]);r?(e.Disciplina=r.id,e.creditoTotal=r.creditoTotal):e.Disciplina=null}}function u(e,t){if(t){var r=t.split(";"),n=Object(a["a"])(r,2),o=n[0],i=n[1];e.Horario1=b(o),e.creditoTotal>=4&&(e.Horario2=b(i)),e.turno1=d(e.Horario1,e.Horario2),"EAD"!==e.turno1&&(e.Sala1=h(o),e.Sala2=h(i))}}function f(e,t){if(t){var r=t.split(";"),n=Object(a["a"])(r,2),o=n[0],i=n[1];e.Docente1=p(o),e.Docente2=p(i)}}function d(e,t){return e||t?31===e?"EAD":Object(i["a"])(n["a"].getters.HorariosNoturno,["id",e])||Object(i["a"])(n["a"].getters.HorariosNoturno,["id",t])?"Noturno":"Diurno":null}function p(e){if(!e)return null;var t=Object(o["a"])(n["a"].getters.AllDocentes,(function(t){return Object(c["f"])(t.nome)===Object(c["f"])(e)}));return t?t.id:null}function b(e){if(!e)return null;var t=e.split(","),r=Object(a["a"])(t,3),i=r[0],c=r[1],s=r[2],l=m(i,c);if(l){var u=Object(o["a"])(n["a"].getters.AllHorarios,["horario",l]);return u?u.id:null}return s.includes("EAD")?31:null}function m(e,t){if(!e||!t)return null;var r=null;switch(e.trim().substring(0,3)){case"SEG":r="2a";break;case"TER":r="3a";break;case"QUA":r="4a";break;case"QUI":r="5a";break;case"SEX":r="6a";break;case"SAB":return"EAD";default:return null}var n=t.split("AS"),o=Object(a["a"])(n,2),i=o[0],c=o[1];if(!i||!c)return null;var s=i.trim().substring(0,2),l=c.trim().substring(0,2);return"".concat(r," ").concat(s,"-").concat(l)}function h(e){if(!e)return null;var t=e.split(","),r=Object(a["a"])(t,3),i=r[2],s=Object(c["f"])(i),l=Object(o["a"])(n["a"].getters.AllSalas,(function(e){var t=Object(c["f"])(e.nome);return s.includes(t)}));return l?l.id:null}function v(e,t,r){var a={Turma:null,Curso:null,vagasOferecidas:0,vagasOcupadas:0},i=Object(o["a"])(n["a"].getters.AllCursos,["codigo",e[t.cursoCod]]);return a.Curso=i?i.id:null,a.Turma=r,a.vagasOferecidas=parseInt(e[t.vagas1],10),a.vagasOcupadas=parseInt(e[t.vagas2],10),a.Curso?a:null}r("ac6a"),r("456d");function g(e){if(e.length){var t=["DISCIPLINA","DISCIPLINA_COD.","TURMA","CURSO_COD.","CURSO","VAGASOFERECIDAS","VAGASOCUPADAS","HORARIOS","DOCENTES"];if(Object.keys(e[0]).length<t.length)throw new Error("Verifique a integridade e o formato do(s) arquivo(s)")}}function O(e){var t={disciplinaCod:null,letra:null,cursoCod:null,vagas1:null,vagas2:null,horarioESala:null,docentes:null},r=0;for(var a in e){if(1===r)t.disciplinaCod=a;else if(2===r)t.letra=a;else if(3===r)t.cursoCod=a;else if(5===r)t.vagas1=a;else if(6===r)t.vagas2=a;else if(7===r)t.horarioESala=a;else if(8===r){t.docentes=a;break}r++}return t}},"4c05":function(e,t,r){"use strict";r("0441")},"4f37":function(e,t,r){"use strict";r("aa77")("trim",(function(e){return function(){return e(this,3)}}))},"9ae6":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._m(0),r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[r("VInputFile",{attrs:{label:"Primeiro período",validation:e.$v.form.file1Periodo,accept:".csv"},model:{value:e.form.file1Periodo,callback:function(t){e.$set(e.form,"file1Periodo",t)},expression:"form.file1Periodo"}})],1),r("div",{staticClass:"col"},[r("VInputFile",{attrs:{label:"Terceiro período",validation:e.$v.form.file3Periodo,accept:".csv"},model:{value:e.form.file3Periodo,callback:function(t){e.$set(e.form,"file3Periodo",t)},expression:"form.file3Periodo"}})],1)]),r("portal",{attrs:{to:"loading-content"}},[r("BaseButton",{staticClass:"paddingX-20",attrs:{color:"gray",text:"Cancelar",disable:e.abortImport},on:{click:function(t){e.abortImport=!0,e.closeModal()}}})],1)],1)},n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",{staticClass:"alert alert-secondary"},[e._v("\n    Selecione arquivos\n    "),r("b",[e._v(".csv")]),e._v("\n    para importar as turmas de cada periodo do novo plano. Note que o formato do arquivo requerido\n    é o relatorio de plano departamental gerado pelo\n    "),r("a",{attrs:{href:"https://siga.ufjf.br",target:"_blank"}},[e._v("SIGA")]),e._v("\n    na página:\n    "),r("b",[e._v("Acadêmico > Consultas > Plano Departamental")]),e._v("\n    . E você pode cancelar o processo durante a importação apertando a tecla esc.\n  ")])}],o=(r("2caf"),r("ac4d"),r("8a81"),r("5df3"),r("1c4c"),r("7f7f"),r("6b54"),r("87b3"),r("1c01"),r("58b2"),r("8e6e"),r("f3e2"),r("d25f"),r("ac6a"),r("456d"),r("96cf"),r("1da1")),i=r("ade3"),c=r("2f62"),s=r("b5ae"),l=r("eaf8"),u=r("348f"),f=r("25df");function d(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=p(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function p(e,t){if(e){if("string"===typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){Object(i["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v={name:"ModalImportPlano",components:{VInputFile:f["i"]},props:{plano:{type:Object,required:!0},closeModal:{type:Function,required:!0}},data:function(){return{abortImport:!1,form:{file1Periodo:null,file3Periodo:null}}},validations:{form:{file1Periodo:{requiredIf:Object(s["requiredIf"])((function(){return!this.form.file3Periodo}))},file3Periodo:{requiredIf:Object(s["requiredIf"])((function(){return!this.form.file1Periodo}))}}},mounted:function(){var e=this;document.addEventListener("keydown",(function(t){t.stopPropagation(),"Escape"===t.code&&(e.abortImport=!0)}))},methods:h(h({},Object(c["b"])(["createPlano","deletePlano","createTurma","createPedidoSIGA","initializeProgressBar","updateProgressBar","finishProgressBar"])),{},{handleImportPlano:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.form.$touch(),!this.$v.form.$anyError){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,this.abortImport=!1,e.next=7,Object(l["g"])(this.form.file1Periodo);case 7:return t=e.sent,e.next=10,Object(l["g"])(this.form.file3Periodo);case 10:return r=e.sent,Object(u["d"])(t),Object(u["d"])(r),this.initializeProgressBar({finalValue:t.length+r.length}),e.next=16,this.createPlano({data:this.plano});case 16:return a=e.sent,e.next=19,this.createTurmasFileSIGA(t,a,1);case 19:return e.next=21,this.createTurmasFileSIGA(r,a,3);case 21:this.abortImport?this.pushNotification({type:"warn",text:"Importação do plano foi cancelada"}):(this.closeModal(),this.pushNotification({type:"success",text:"Plano criado e turmas importadas"})),e.next=27;break;case 24:e.prev=24,e.t0=e["catch"](3),this.pushNotification({type:"error",title:"Erro ao criar plano!",text:e.t0.message});case 27:return e.prev=27,e.next=30,this.finishProgressBar();case 30:return e.finish(27);case 31:case"end":return e.stop()}}),e,this,[[3,24,27,31]])})));function t(){return e.apply(this,arguments)}return t}(),createTurmasFileSIGA:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,r,a){var n,o,i,c,s,l,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:n={},o=Object(u["a"])(t[0]),i=d(t),e.prev=5,i.s();case 7:if((c=i.n()).done){e.next=29;break}if(s=c.value,!this.abortImport){e.next=12;break}return this.deletePlano({data:h({},r)}),e.abrupt("break",29);case 12:if(this.updateProgressBar(),l=Object(u["c"])(s,o,r.id,a),l){e.next=16;break}return e.abrupt("continue",27);case 16:if(!this.turmasIsEqual(n,l)){e.next=21;break}return e.next=19,this.handleCreatePedidoSIGA(s,o,n.id);case 19:e.next=27;break;case 21:return e.next=23,this.createTurma({data:l});case 23:return f=e.sent,e.next=26,this.handleCreatePedidoSIGA(s,o,f.id);case 26:n=h({},f);case 27:e.next=7;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e["catch"](5),i.e(e.t0);case 34:return e.prev=34,i.f(),e.finish(34);case 37:case"end":return e.stop()}}),e,this,[[5,31,34,37]])})));function t(t,r,a){return e.apply(this,arguments)}return t}(),handleCreatePedidoSIGA:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,r,a){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object(u["b"])(t,r,a),!n){e.next=4;break}return e.next=4,this.createPedidoSIGA({data:n}).catch((function(){}));case 4:case"end":return e.stop()}}),e,this)})));function t(t,r,a){return e.apply(this,arguments)}return t}(),turmasIsEqual:function(e,t){return e.letra===t.letra&&e.Disciplina===t.Disciplina}})},g=v,O=(r("0bad"),r("2877")),P=Object(O["a"])(g,a,n,!1,null,"6e79f9c9",null);t["default"]=P.exports},af8d:function(e,t,r){}}]);
//# sourceMappingURL=chunk-47393c0a.437824fb.js.map